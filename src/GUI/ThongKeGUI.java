/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/GUIForms/JPanel.java to edit this template
 */
package GUI;

import BUS.ThongKeBUS;
import DTO.ThongKe.ThongKeDoanhThuDTO;
import DTO.ThongKe.ThongKeHoaDonBanDTO;
import DTO.ThongKe.ThongKeSanPhamBanDTO;
import DTO.ThongKe.ThongKeTheLoaiBanDTO;
import ExportFile.ExcelExporter;
import ExportFile.PdfExporter;
import GUI.Component.Chart.BarChart.Chart;
import GUI.Component.Chart.BarChart.ModelChart;
import Util.sharedFunction;
import com.toedter.calendar.JDateChooser;
import java.awt.Color;
import java.awt.Cursor;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Calendar;
import java.util.Collections;
import java.util.List;
import java.util.Set;
import javax.swing.JComboBox;
import javax.swing.JOptionPane;
import javax.swing.table.DefaultTableModel;

/**
 *
 * @Nhóm 13
 */
public final class ThongKeGUI extends javax.swing.JPanel {

    /**
     * Creates new form ThongKeGUI
     */
    private ThongKeBUS tkBUS = new ThongKeBUS();
    Chart chart;

    public ThongKeGUI() {
        initComponents();
        setDefaultValues(spngaybatdau, spngayketthuc, CbThoiGianSanPham);
        setDefaultValues(tlngaybatdau, tlngayketthuc, CbThoiGianTheLoai);
        setDefaultValues(tgngaybatdau, tgngayketthuc, CbThoiGian);
        setDefaultValues(DoanhThutgngaybatdau, DoanhThutgngayketthuc, CbThoiGian);
        populateComboBoxALL();
        thongKeDoanhThuTuNamDenNam();
        thongKeDoanhThuTheoThangTrongNam();
        ThongKeDoanhThuTungNgayTrongThang();
        ThongKeDoanhThuTuNgayDenNgay();
        thongKeSanPhamBanTrongKhoangThoiGian();
        thongKeTheLoaiBanTrongKhoangThoiGian();
        thongKeHoaDonTrongKhoangThoiGian();
        formatTable();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jPanel5 = new javax.swing.JPanel();
        jLabel6 = new javax.swing.JLabel();
        jLabel5 = new javax.swing.JLabel();
        jTabbedPane1 = new javax.swing.JTabbedPane();
        jPanel2 = new javax.swing.JPanel();
        jTabbedPanel = new javax.swing.JTabbedPane();
        ThongKeTheoNam = new javax.swing.JPanel();
        PanelThongKeTheoNam = new javax.swing.JPanel();
        cbNamKetThuc = new javax.swing.JComboBox<>();
        cbNamBatDau = new javax.swing.JComboBox<>();
        pdfBtnDoanhThuTheoNam = new Components.ButtonRadius();
        excelBtnDoanhThuTheoNam = new Components.ButtonRadius();
        jScrollPane1 = new javax.swing.JScrollPane();
        tableTheoNam = new javax.swing.JTable();
        lblNamBatDau = new javax.swing.JLabel();
        lblNamKetThuc = new javax.swing.JLabel();
        jPanelChartNam = new javax.swing.JPanel();
        ThongKeTheoThangTrongNam = new javax.swing.JPanel();
        PanelThongKeTheoThang = new javax.swing.JPanel();
        cbNam = new javax.swing.JComboBox<>();
        jScrollPane2 = new javax.swing.JScrollPane();
        tableTheoThang = new javax.swing.JTable();
        lblNam = new javax.swing.JLabel();
        pdfBtnTheoThang = new Components.ButtonRadius();
        excelBtnTheoThang = new Components.ButtonRadius();
        jPanelChartThang = new javax.swing.JPanel();
        ThongKeTheoNgayTrongThang = new javax.swing.JPanel();
        PanelThongKeTheoThang1 = new javax.swing.JPanel();
        jScrollPane6 = new javax.swing.JScrollPane();
        tableTheoTungNgayTrongThang = new javax.swing.JTable();
        lblNam1 = new javax.swing.JLabel();
        cbThang = new javax.swing.JComboBox<>();
        lblNamKetThuc2 = new javax.swing.JLabel();
        btnThem3 = new Components.ButtonRadius();
        btnThem5 = new Components.ButtonRadius();
        cbNam1 = new javax.swing.JComboBox<>();
        jPanelChartNgay = new javax.swing.JPanel();
        ThongKeTuNgayDenNgay = new javax.swing.JPanel();
        PanelThongKeTheoThang2 = new javax.swing.JPanel();
        jScrollPane7 = new javax.swing.JScrollPane();
        TableTuNgayDenNgay = new javax.swing.JTable();
        btnThem6 = new Components.ButtonRadius();
        btnThem8 = new Components.ButtonRadius();
        lblThoiGian3 = new javax.swing.JLabel();
        DoanhThuCbThoiGian = new javax.swing.JComboBox<>();
        DoanhThutgngaybatdau = new com.toedter.calendar.JDateChooser();
        DoanhThutgngayketthuc = new com.toedter.calendar.JDateChooser();
        jPanel1 = new javax.swing.JPanel();
        jTabbedPaneTheLoai = new javax.swing.JTabbedPane();
        jPanel7 = new javax.swing.JPanel();
        jScrollPane3 = new javax.swing.JScrollPane();
        TableSanPham = new javax.swing.JTable();
        CbThoiGianSanPham = new javax.swing.JComboBox<>();
        lblThoiGian = new javax.swing.JLabel();
        CbTieuChi = new javax.swing.JComboBox<>();
        excelBtn = new Components.ButtonRadius();
        pdfBtn = new Components.ButtonRadius();
        spngayketthuc = new com.toedter.calendar.JDateChooser();
        spngaybatdau = new com.toedter.calendar.JDateChooser();
        jPanelChartSanPhamBan = new javax.swing.JPanel();
        cbTopSanPham = new javax.swing.JComboBox<>();
        jPanel12 = new javax.swing.JPanel();
        jScrollPane9 = new javax.swing.JScrollPane();
        TableTheLoai = new javax.swing.JTable();
        CbThoiGianTheLoai = new javax.swing.JComboBox<>();
        lblThoiGian2 = new javax.swing.JLabel();
        CbTieuChiTheLoai = new javax.swing.JComboBox<>();
        excelBtnTheLoai = new Components.ButtonRadius();
        pdfBtnTheLoai = new Components.ButtonRadius();
        tlngayketthuc = new com.toedter.calendar.JDateChooser();
        tlngaybatdau = new com.toedter.calendar.JDateChooser();
        jPanelChartTheLoai = new javax.swing.JPanel();
        cbTopTheLoai = new javax.swing.JComboBox<>();
        jPanel9 = new javax.swing.JPanel();
        jScrollPane4 = new javax.swing.JScrollPane();
        TableThoiGian = new javax.swing.JTable();
        lblThoiGian1 = new javax.swing.JLabel();
        CbThoiGian = new javax.swing.JComboBox<>();
        tgngaybatdau = new com.toedter.calendar.JDateChooser();
        tgngayketthuc = new com.toedter.calendar.JDateChooser();
        excelThoiGian = new Components.ButtonRadius();
        pdfThoiGian = new Components.ButtonRadius();

        setMaximumSize(new java.awt.Dimension(1020, 750));
        setPreferredSize(new java.awt.Dimension(1020, 750));

        jPanel5.setBackground(new java.awt.Color(255, 255, 255));
        jPanel5.setMaximumSize(new java.awt.Dimension(1020, 750));
        jPanel5.setMinimumSize(new java.awt.Dimension(1020, 750));
        jPanel5.setPreferredSize(new java.awt.Dimension(1020, 750));

        jLabel6.setFont(new java.awt.Font("Josefin Sans SemiBold", 0, 18)); // NOI18N
        jLabel6.setForeground(new java.awt.Color(253, 183, 58));
        jLabel6.setText("Thống kê");

        jLabel5.setFont(new java.awt.Font("Josefin Sans SemiBold", 0, 18)); // NOI18N
        jLabel5.setForeground(new java.awt.Color(253, 183, 58));
        jLabel5.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Assets/icon_40px/dashboard_1.png"))); // NOI18N

        jTabbedPane1.setBackground(new java.awt.Color(255, 255, 255));
        jTabbedPane1.setFont(new java.awt.Font("Segoe UI", 0, 14)); // NOI18N
        jTabbedPane1.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                jTabbedPane1MouseClicked(evt);
            }
        });

        jTabbedPanel.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                jTabbedPanelMouseClicked(evt);
            }
        });

        ThongKeTheoNam.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                ThongKeTheoNamMouseClicked(evt);
            }
        });

        cbNamKetThuc.setToolTipText("");
        cbNamKetThuc.setBorder(null);
        cbNamKetThuc.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                cbNamKetThucItemStateChanged(evt);
            }
        });
        cbNamKetThuc.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cbNamKetThucActionPerformed(evt);
            }
        });

        cbNamBatDau.setBorder(null);
        cbNamBatDau.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                cbNamBatDauItemStateChanged(evt);
            }
        });
        cbNamBatDau.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cbNamBatDauActionPerformed(evt);
            }
        });

        pdfBtnDoanhThuTheoNam.setBorder(null);
        pdfBtnDoanhThuTheoNam.setForeground(new java.awt.Color(135, 172, 217));
        pdfBtnDoanhThuTheoNam.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Assets/icon_24px/pdf.png"))); // NOI18N
        pdfBtnDoanhThuTheoNam.setText("In PDF");
        pdfBtnDoanhThuTheoNam.setFocusPainted(false);
        pdfBtnDoanhThuTheoNam.setFont(new java.awt.Font("Josefin Sans SemiBold", 0, 17)); // NOI18N
        pdfBtnDoanhThuTheoNam.setIconTextGap(0);
        pdfBtnDoanhThuTheoNam.setMargin(new java.awt.Insets(0, 0, 0, 0));
        pdfBtnDoanhThuTheoNam.setMaximumSize(new java.awt.Dimension(100, 40));
        pdfBtnDoanhThuTheoNam.setPreferredSize(new java.awt.Dimension(100, 40));
        pdfBtnDoanhThuTheoNam.setRadius(40);
        pdfBtnDoanhThuTheoNam.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseEntered(java.awt.event.MouseEvent evt) {
                pdfBtnDoanhThuTheoNamMouseEntered(evt);
            }
            public void mouseExited(java.awt.event.MouseEvent evt) {
                pdfBtnDoanhThuTheoNamMouseExited(evt);
            }
        });
        pdfBtnDoanhThuTheoNam.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                pdfBtnDoanhThuTheoNamActionPerformed(evt);
            }
        });

        excelBtnDoanhThuTheoNam.setBorder(null);
        excelBtnDoanhThuTheoNam.setForeground(new java.awt.Color(135, 172, 217));
        excelBtnDoanhThuTheoNam.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Assets/icon_24px/excel.png"))); // NOI18N
        excelBtnDoanhThuTheoNam.setText("Xuất Excel");
        excelBtnDoanhThuTheoNam.setFocusPainted(false);
        excelBtnDoanhThuTheoNam.setFont(new java.awt.Font("Josefin Sans SemiBold", 0, 17)); // NOI18N
        excelBtnDoanhThuTheoNam.setIconTextGap(0);
        excelBtnDoanhThuTheoNam.setMargin(new java.awt.Insets(0, 0, 0, 0));
        excelBtnDoanhThuTheoNam.setMaximumSize(new java.awt.Dimension(100, 40));
        excelBtnDoanhThuTheoNam.setPreferredSize(new java.awt.Dimension(100, 40));
        excelBtnDoanhThuTheoNam.setRadius(40);
        excelBtnDoanhThuTheoNam.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseEntered(java.awt.event.MouseEvent evt) {
                excelBtnDoanhThuTheoNamMouseEntered(evt);
            }
            public void mouseExited(java.awt.event.MouseEvent evt) {
                excelBtnDoanhThuTheoNamMouseExited(evt);
            }
        });
        excelBtnDoanhThuTheoNam.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                excelBtnDoanhThuTheoNamActionPerformed(evt);
            }
        });

        tableTheoNam.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null}
            },
            new String [] {
                "Năm", "Vốn ", "Doanh thu", "Lợi nhuận"
            }
        ) {
            Class[] types = new Class [] {
                java.lang.Integer.class, java.lang.String.class, java.lang.String.class, java.lang.String.class
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }
        });
        tableTheoNam.setEnabled(false);
        tableTheoNam.setFocusable(false);
        jScrollPane1.setViewportView(tableTheoNam);

        lblNamBatDau.setFont(new java.awt.Font("Segoe UI", 0, 14)); // NOI18N
        lblNamBatDau.setForeground(new java.awt.Color(135, 172, 217));
        lblNamBatDau.setText("Từ năm");

        lblNamKetThuc.setFont(new java.awt.Font("Segoe UI", 0, 14)); // NOI18N
        lblNamKetThuc.setForeground(new java.awt.Color(135, 172, 217));
        lblNamKetThuc.setText("Đến năm");

        javax.swing.GroupLayout PanelThongKeTheoNamLayout = new javax.swing.GroupLayout(PanelThongKeTheoNam);
        PanelThongKeTheoNam.setLayout(PanelThongKeTheoNamLayout);
        PanelThongKeTheoNamLayout.setHorizontalGroup(
            PanelThongKeTheoNamLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(PanelThongKeTheoNamLayout.createSequentialGroup()
                .addGap(197, 197, 197)
                .addComponent(lblNamBatDau, javax.swing.GroupLayout.PREFERRED_SIZE, 60, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(cbNamBatDau, javax.swing.GroupLayout.PREFERRED_SIZE, 100, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(27, 27, 27)
                .addComponent(lblNamKetThuc)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(cbNamKetThuc, javax.swing.GroupLayout.PREFERRED_SIZE, 100, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(172, 172, 172)
                .addComponent(excelBtnDoanhThuTheoNam, javax.swing.GroupLayout.PREFERRED_SIZE, 129, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(pdfBtnDoanhThuTheoNam, javax.swing.GroupLayout.PREFERRED_SIZE, 118, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
            .addGroup(PanelThongKeTheoNamLayout.createSequentialGroup()
                .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 995, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 17, Short.MAX_VALUE))
        );
        PanelThongKeTheoNamLayout.setVerticalGroup(
            PanelThongKeTheoNamLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(PanelThongKeTheoNamLayout.createSequentialGroup()
                .addGroup(PanelThongKeTheoNamLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(PanelThongKeTheoNamLayout.createSequentialGroup()
                        .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addGroup(PanelThongKeTheoNamLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(lblNamBatDau, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(lblNamKetThuc, javax.swing.GroupLayout.PREFERRED_SIZE, 29, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(cbNamBatDau, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(cbNamKetThuc, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(17, 17, 17))
                    .addGroup(PanelThongKeTheoNamLayout.createSequentialGroup()
                        .addContainerGap()
                        .addGroup(PanelThongKeTheoNamLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(pdfBtnDoanhThuTheoNam, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(excelBtnDoanhThuTheoNam, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))))
                .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 285, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );

        jPanelChartNam.setBackground(new java.awt.Color(102, 51, 255));
        jPanelChartNam.setLayout(new java.awt.BorderLayout());

        javax.swing.GroupLayout ThongKeTheoNamLayout = new javax.swing.GroupLayout(ThongKeTheoNam);
        ThongKeTheoNam.setLayout(ThongKeTheoNamLayout);
        ThongKeTheoNamLayout.setHorizontalGroup(
            ThongKeTheoNamLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(PanelThongKeTheoNam, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
            .addGroup(ThongKeTheoNamLayout.createSequentialGroup()
                .addComponent(jPanelChartNam, javax.swing.GroupLayout.PREFERRED_SIZE, 995, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 0, Short.MAX_VALUE))
        );
        ThongKeTheoNamLayout.setVerticalGroup(
            ThongKeTheoNamLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(ThongKeTheoNamLayout.createSequentialGroup()
                .addComponent(PanelThongKeTheoNam, javax.swing.GroupLayout.PREFERRED_SIZE, 334, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanelChartNam, javax.swing.GroupLayout.PREFERRED_SIZE, 309, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(75, Short.MAX_VALUE))
        );

        jTabbedPanel.addTab("Thống kê theo năm", ThongKeTheoNam);

        ThongKeTheoThangTrongNam.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                ThongKeTheoThangTrongNamMouseClicked(evt);
            }
        });

        cbNam.setToolTipText("");
        cbNam.setBorder(null);
        cbNam.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                cbNamItemStateChanged(evt);
            }
        });

        tableTheoThang.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null}
            },
            new String [] {
                "Tháng", "Vốn ", "Doanh thu", "Lợi nhuận"
            }
        ) {
            Class[] types = new Class [] {
                java.lang.Integer.class, java.lang.String.class, java.lang.String.class, java.lang.String.class
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }
        });
        tableTheoThang.setEnabled(false);
        tableTheoThang.setFocusable(false);
        jScrollPane2.setViewportView(tableTheoThang);

        lblNam.setFont(new java.awt.Font("Segoe UI", 0, 14)); // NOI18N
        lblNam.setForeground(new java.awt.Color(135, 172, 217));
        lblNam.setText("Chọn năm");

        pdfBtnTheoThang.setBorder(null);
        pdfBtnTheoThang.setForeground(new java.awt.Color(135, 172, 217));
        pdfBtnTheoThang.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Assets/icon_24px/pdf.png"))); // NOI18N
        pdfBtnTheoThang.setText("In pdf");
        pdfBtnTheoThang.setFocusPainted(false);
        pdfBtnTheoThang.setFont(new java.awt.Font("Josefin Sans SemiBold", 0, 17)); // NOI18N
        pdfBtnTheoThang.setMaximumSize(new java.awt.Dimension(100, 40));
        pdfBtnTheoThang.setPreferredSize(new java.awt.Dimension(100, 40));
        pdfBtnTheoThang.setRadius(40);
        pdfBtnTheoThang.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseEntered(java.awt.event.MouseEvent evt) {
                pdfBtnTheoThangMouseEntered(evt);
            }
            public void mouseExited(java.awt.event.MouseEvent evt) {
                pdfBtnTheoThangMouseExited(evt);
            }
        });
        pdfBtnTheoThang.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                pdfBtnTheoThangActionPerformed(evt);
            }
        });

        excelBtnTheoThang.setBorder(null);
        excelBtnTheoThang.setForeground(new java.awt.Color(135, 172, 217));
        excelBtnTheoThang.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Assets/icon_24px/excel.png"))); // NOI18N
        excelBtnTheoThang.setText("Xuất excel");
        excelBtnTheoThang.setFocusPainted(false);
        excelBtnTheoThang.setFont(new java.awt.Font("Josefin Sans SemiBold", 0, 17)); // NOI18N
        excelBtnTheoThang.setHorizontalAlignment(javax.swing.SwingConstants.LEFT);
        excelBtnTheoThang.setHorizontalTextPosition(javax.swing.SwingConstants.RIGHT);
        excelBtnTheoThang.setMaximumSize(new java.awt.Dimension(100, 40));
        excelBtnTheoThang.setPreferredSize(new java.awt.Dimension(100, 40));
        excelBtnTheoThang.setRadius(40);
        excelBtnTheoThang.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseEntered(java.awt.event.MouseEvent evt) {
                excelBtnTheoThangMouseEntered(evt);
            }
            public void mouseExited(java.awt.event.MouseEvent evt) {
                excelBtnTheoThangMouseExited(evt);
            }
        });
        excelBtnTheoThang.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                excelBtnTheoThangActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout PanelThongKeTheoThangLayout = new javax.swing.GroupLayout(PanelThongKeTheoThang);
        PanelThongKeTheoThang.setLayout(PanelThongKeTheoThangLayout);
        PanelThongKeTheoThangLayout.setHorizontalGroup(
            PanelThongKeTheoThangLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(PanelThongKeTheoThangLayout.createSequentialGroup()
                .addGroup(PanelThongKeTheoThangLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jScrollPane2)
                    .addGroup(PanelThongKeTheoThangLayout.createSequentialGroup()
                        .addGap(272, 272, 272)
                        .addComponent(lblNam)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(cbNam, javax.swing.GroupLayout.PREFERRED_SIZE, 100, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(265, 265, 265)
                        .addComponent(excelBtnTheoThang, javax.swing.GroupLayout.PREFERRED_SIZE, 138, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(18, 18, 18)
                        .addComponent(pdfBtnTheoThang, javax.swing.GroupLayout.PREFERRED_SIZE, 121, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(0, 0, Short.MAX_VALUE)))
                .addContainerGap())
        );
        PanelThongKeTheoThangLayout.setVerticalGroup(
            PanelThongKeTheoThangLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(PanelThongKeTheoThangLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(PanelThongKeTheoThangLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(PanelThongKeTheoThangLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(lblNam, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(cbNam, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(pdfBtnTheoThang, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(excelBtnTheoThang, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(jScrollPane2, javax.swing.GroupLayout.PREFERRED_SIZE, 302, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(17, 17, 17))
        );

        jPanelChartThang.setBackground(new java.awt.Color(102, 51, 255));
        jPanelChartThang.setLayout(new java.awt.BorderLayout());

        javax.swing.GroupLayout ThongKeTheoThangTrongNamLayout = new javax.swing.GroupLayout(ThongKeTheoThangTrongNam);
        ThongKeTheoThangTrongNam.setLayout(ThongKeTheoThangTrongNamLayout);
        ThongKeTheoThangTrongNamLayout.setHorizontalGroup(
            ThongKeTheoThangTrongNamLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(PanelThongKeTheoThang, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
            .addGroup(ThongKeTheoThangTrongNamLayout.createSequentialGroup()
                .addComponent(jPanelChartThang, javax.swing.GroupLayout.PREFERRED_SIZE, 1002, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 10, Short.MAX_VALUE))
        );
        ThongKeTheoThangTrongNamLayout.setVerticalGroup(
            ThongKeTheoThangTrongNamLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(ThongKeTheoThangTrongNamLayout.createSequentialGroup()
                .addComponent(PanelThongKeTheoThang, javax.swing.GroupLayout.PREFERRED_SIZE, 353, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanelChartThang, javax.swing.GroupLayout.PREFERRED_SIZE, 291, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(74, Short.MAX_VALUE))
        );

        jTabbedPanel.addTab("Thống kê từng tháng trong năm", ThongKeTheoThangTrongNam);

        ThongKeTheoNgayTrongThang.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                ThongKeTheoNgayTrongThangMouseClicked(evt);
            }
        });

        tableTheoTungNgayTrongThang.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null}
            },
            new String [] {
                "Ngày", "Vốn ", "Doanh thu", "Lợi nhuận"
            }
        ) {
            Class[] types = new Class [] {
                java.lang.Integer.class, java.lang.String.class, java.lang.String.class, java.lang.String.class
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }
        });
        tableTheoTungNgayTrongThang.setEnabled(false);
        tableTheoTungNgayTrongThang.setFocusable(false);
        jScrollPane6.setViewportView(tableTheoTungNgayTrongThang);

        lblNam1.setFont(new java.awt.Font("Segoe UI", 0, 14)); // NOI18N
        lblNam1.setForeground(new java.awt.Color(135, 172, 217));
        lblNam1.setText("Chọn năm");

        cbThang.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Tháng 1", "Tháng 2", "Tháng 3", "Tháng 4", "Tháng 5", "Tháng 6", "Tháng 7", "Tháng 8", "Tháng 9", "Tháng 10", "Tháng 11", "Tháng 12" }));
        cbThang.setToolTipText("");
        cbThang.setBorder(null);
        cbThang.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                cbThangItemStateChanged(evt);
            }
        });

        lblNamKetThuc2.setFont(new java.awt.Font("Segoe UI", 0, 14)); // NOI18N
        lblNamKetThuc2.setForeground(new java.awt.Color(135, 172, 217));
        lblNamKetThuc2.setText("Chọn tháng");

        btnThem3.setBorder(null);
        btnThem3.setForeground(new java.awt.Color(135, 172, 217));
        btnThem3.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Assets/icon_24px/pdf.png"))); // NOI18N
        btnThem3.setText("In pdf");
        btnThem3.setFocusPainted(false);
        btnThem3.setFont(new java.awt.Font("Josefin Sans SemiBold", 0, 17)); // NOI18N
        btnThem3.setMaximumSize(new java.awt.Dimension(100, 40));
        btnThem3.setPreferredSize(new java.awt.Dimension(100, 40));
        btnThem3.setRadius(40);
        btnThem3.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnThem3ActionPerformed(evt);
            }
        });

        btnThem5.setBorder(null);
        btnThem5.setForeground(new java.awt.Color(135, 172, 217));
        btnThem5.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Assets/icon_24px/excel.png"))); // NOI18N
        btnThem5.setText("Xuất excel");
        btnThem5.setFocusPainted(false);
        btnThem5.setFont(new java.awt.Font("Josefin Sans SemiBold", 0, 17)); // NOI18N
        btnThem5.setMaximumSize(new java.awt.Dimension(100, 40));
        btnThem5.setPreferredSize(new java.awt.Dimension(100, 40));
        btnThem5.setRadius(40);
        btnThem5.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnThem5ActionPerformed(evt);
            }
        });

        cbNam1.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                cbNam1ItemStateChanged(evt);
            }
        });

        javax.swing.GroupLayout PanelThongKeTheoThang1Layout = new javax.swing.GroupLayout(PanelThongKeTheoThang1);
        PanelThongKeTheoThang1.setLayout(PanelThongKeTheoThang1Layout);
        PanelThongKeTheoThang1Layout.setHorizontalGroup(
            PanelThongKeTheoThang1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(PanelThongKeTheoThang1Layout.createSequentialGroup()
                .addGroup(PanelThongKeTheoThang1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(jScrollPane6, javax.swing.GroupLayout.PREFERRED_SIZE, 998, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(PanelThongKeTheoThang1Layout.createSequentialGroup()
                        .addComponent(lblNam1)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(cbNam1, javax.swing.GroupLayout.PREFERRED_SIZE, 96, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(44, 44, 44)
                        .addComponent(lblNamKetThuc2, javax.swing.GroupLayout.PREFERRED_SIZE, 84, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(cbThang, javax.swing.GroupLayout.PREFERRED_SIZE, 100, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(277, 277, 277)
                        .addComponent(btnThem5, javax.swing.GroupLayout.PREFERRED_SIZE, 130, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(31, 31, 31)
                        .addComponent(btnThem3, javax.swing.GroupLayout.PREFERRED_SIZE, 115, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        PanelThongKeTheoThang1Layout.setVerticalGroup(
            PanelThongKeTheoThang1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(PanelThongKeTheoThang1Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(PanelThongKeTheoThang1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(PanelThongKeTheoThang1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(lblNam1, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(lblNamKetThuc2, javax.swing.GroupLayout.PREFERRED_SIZE, 29, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(cbThang, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(cbNam1, javax.swing.GroupLayout.PREFERRED_SIZE, 29, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(btnThem3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btnThem5, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(jScrollPane6, javax.swing.GroupLayout.DEFAULT_SIZE, 295, Short.MAX_VALUE)
                .addContainerGap())
        );

        jPanelChartNgay.setBackground(new java.awt.Color(102, 51, 255));
        jPanelChartNgay.setLayout(new java.awt.BorderLayout());

        javax.swing.GroupLayout ThongKeTheoNgayTrongThangLayout = new javax.swing.GroupLayout(ThongKeTheoNgayTrongThang);
        ThongKeTheoNgayTrongThang.setLayout(ThongKeTheoNgayTrongThangLayout);
        ThongKeTheoNgayTrongThangLayout.setHorizontalGroup(
            ThongKeTheoNgayTrongThangLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(PanelThongKeTheoThang1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
            .addComponent(jPanelChartNgay, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );
        ThongKeTheoNgayTrongThangLayout.setVerticalGroup(
            ThongKeTheoNgayTrongThangLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(ThongKeTheoNgayTrongThangLayout.createSequentialGroup()
                .addComponent(PanelThongKeTheoThang1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanelChartNgay, javax.swing.GroupLayout.PREFERRED_SIZE, 289, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );

        jTabbedPanel.addTab("Thống kê từng ngày trong tháng", ThongKeTheoNgayTrongThang);

        ThongKeTuNgayDenNgay.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                ThongKeTuNgayDenNgayMouseClicked(evt);
            }
        });

        TableTuNgayDenNgay.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "Ngày", "Vốn ", "Doanh thu", "Lợi nhuận"
            }
        ) {
            Class[] types = new Class [] {
                java.lang.Integer.class, java.lang.String.class, java.lang.String.class, java.lang.String.class
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }
        });
        TableTuNgayDenNgay.setEnabled(false);
        TableTuNgayDenNgay.setFocusable(false);
        jScrollPane7.setViewportView(TableTuNgayDenNgay);

        btnThem6.setBorder(null);
        btnThem6.setForeground(new java.awt.Color(135, 172, 217));
        btnThem6.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Assets/icon_24px/pdf.png"))); // NOI18N
        btnThem6.setText("In pdf");
        btnThem6.setFocusPainted(false);
        btnThem6.setFont(new java.awt.Font("Josefin Sans SemiBold", 0, 17)); // NOI18N
        btnThem6.setMaximumSize(new java.awt.Dimension(100, 40));
        btnThem6.setPreferredSize(new java.awt.Dimension(100, 40));
        btnThem6.setRadius(40);
        btnThem6.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnThem6ActionPerformed(evt);
            }
        });

        btnThem8.setBorder(null);
        btnThem8.setForeground(new java.awt.Color(135, 172, 217));
        btnThem8.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Assets/icon_24px/excel.png"))); // NOI18N
        btnThem8.setText("Xuất excel");
        btnThem8.setFocusPainted(false);
        btnThem8.setFont(new java.awt.Font("Josefin Sans SemiBold", 0, 17)); // NOI18N
        btnThem8.setMaximumSize(new java.awt.Dimension(100, 40));
        btnThem8.setPreferredSize(new java.awt.Dimension(100, 40));
        btnThem8.setRadius(40);
        btnThem8.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnThem8ActionPerformed(evt);
            }
        });

        lblThoiGian3.setText("Khoảng thời gian");

        DoanhThuCbThoiGian.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Hôm nay", "Hôm qua", "7 ngày qua", "30 ngày qua", "Tháng trước", "Tháng này", "Năm trước", "Năm nay", "Tùy chọn khác" }));
        DoanhThuCbThoiGian.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                DoanhThuCbThoiGianItemStateChanged(evt);
            }
        });
        DoanhThuCbThoiGian.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                DoanhThuCbThoiGianActionPerformed(evt);
            }
        });

        DoanhThutgngaybatdau.addPropertyChangeListener(new java.beans.PropertyChangeListener() {
            public void propertyChange(java.beans.PropertyChangeEvent evt) {
                DoanhThutgngaybatdauPropertyChange(evt);
            }
        });

        DoanhThutgngayketthuc.addPropertyChangeListener(new java.beans.PropertyChangeListener() {
            public void propertyChange(java.beans.PropertyChangeEvent evt) {
                DoanhThutgngayketthucPropertyChange(evt);
            }
        });

        javax.swing.GroupLayout PanelThongKeTheoThang2Layout = new javax.swing.GroupLayout(PanelThongKeTheoThang2);
        PanelThongKeTheoThang2.setLayout(PanelThongKeTheoThang2Layout);
        PanelThongKeTheoThang2Layout.setHorizontalGroup(
            PanelThongKeTheoThang2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, PanelThongKeTheoThang2Layout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGroup(PanelThongKeTheoThang2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addGroup(PanelThongKeTheoThang2Layout.createSequentialGroup()
                        .addComponent(lblThoiGian3, javax.swing.GroupLayout.PREFERRED_SIZE, 98, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(DoanhThuCbThoiGian, javax.swing.GroupLayout.PREFERRED_SIZE, 96, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(DoanhThutgngaybatdau, javax.swing.GroupLayout.PREFERRED_SIZE, 131, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(DoanhThutgngayketthuc, javax.swing.GroupLayout.PREFERRED_SIZE, 129, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(btnThem8, javax.swing.GroupLayout.PREFERRED_SIZE, 127, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(18, 18, 18)
                        .addComponent(btnThem6, javax.swing.GroupLayout.PREFERRED_SIZE, 115, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(jScrollPane7, javax.swing.GroupLayout.PREFERRED_SIZE, 974, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(24, 24, 24))
        );
        PanelThongKeTheoThang2Layout.setVerticalGroup(
            PanelThongKeTheoThang2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(PanelThongKeTheoThang2Layout.createSequentialGroup()
                .addGap(16, 16, 16)
                .addGroup(PanelThongKeTheoThang2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(PanelThongKeTheoThang2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(btnThem6, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(btnThem8, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                    .addGroup(PanelThongKeTheoThang2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(lblThoiGian3, javax.swing.GroupLayout.PREFERRED_SIZE, 31, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(DoanhThuCbThoiGian, javax.swing.GroupLayout.PREFERRED_SIZE, 31, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(DoanhThutgngaybatdau, javax.swing.GroupLayout.PREFERRED_SIZE, 31, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(DoanhThutgngayketthuc, javax.swing.GroupLayout.PREFERRED_SIZE, 31, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addComponent(jScrollPane7, javax.swing.GroupLayout.PREFERRED_SIZE, 561, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(89, Short.MAX_VALUE))
        );

        javax.swing.GroupLayout ThongKeTuNgayDenNgayLayout = new javax.swing.GroupLayout(ThongKeTuNgayDenNgay);
        ThongKeTuNgayDenNgay.setLayout(ThongKeTuNgayDenNgayLayout);
        ThongKeTuNgayDenNgayLayout.setHorizontalGroup(
            ThongKeTuNgayDenNgayLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(PanelThongKeTheoThang2, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );
        ThongKeTuNgayDenNgayLayout.setVerticalGroup(
            ThongKeTuNgayDenNgayLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(PanelThongKeTheoThang2, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );

        jTabbedPanel.addTab("Thống kê từ ngày đến ngày", ThongKeTuNgayDenNgay);

        javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);
        jPanel2.setLayout(jPanel2Layout);
        jPanel2Layout.setHorizontalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel2Layout.createSequentialGroup()
                .addGap(0, 0, Short.MAX_VALUE)
                .addComponent(jTabbedPanel, javax.swing.GroupLayout.PREFERRED_SIZE, 1012, javax.swing.GroupLayout.PREFERRED_SIZE))
        );
        jPanel2Layout.setVerticalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jTabbedPanel)
        );

        jTabbedPane1.addTab("Doanh thu", jPanel2);

        TableSanPham.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null, null, null},
                {null, null, null, null, null, null},
                {null, null, null, null, null, null},
                {null, null, null, null, null, null}
            },
            new String [] {
                "STT", "MaSP", "TenSP", "SL bán", "SL đơn  bán", "Doanh thu "
            }
        ) {
            Class[] types = new Class [] {
                java.lang.Integer.class, java.lang.String.class, java.lang.String.class, java.lang.Integer.class, java.lang.Integer.class, java.lang.String.class
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }
        });
        jScrollPane3.setViewportView(TableSanPham);
        if (TableSanPham.getColumnModel().getColumnCount() > 0) {
            TableSanPham.getColumnModel().getColumn(1).setMinWidth(120);
            TableSanPham.getColumnModel().getColumn(1).setPreferredWidth(120);
            TableSanPham.getColumnModel().getColumn(1).setMaxWidth(120);
            TableSanPham.getColumnModel().getColumn(2).setMinWidth(300);
            TableSanPham.getColumnModel().getColumn(2).setPreferredWidth(300);
            TableSanPham.getColumnModel().getColumn(2).setMaxWidth(300);
            TableSanPham.getColumnModel().getColumn(3).setMinWidth(110);
            TableSanPham.getColumnModel().getColumn(3).setPreferredWidth(110);
            TableSanPham.getColumnModel().getColumn(3).setMaxWidth(110);
            TableSanPham.getColumnModel().getColumn(4).setMinWidth(110);
            TableSanPham.getColumnModel().getColumn(4).setPreferredWidth(110);
            TableSanPham.getColumnModel().getColumn(4).setMaxWidth(110);
            TableSanPham.getColumnModel().getColumn(5).setMinWidth(180);
            TableSanPham.getColumnModel().getColumn(5).setPreferredWidth(180);
            TableSanPham.getColumnModel().getColumn(5).setMaxWidth(180);
        }

        CbThoiGianSanPham.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Hôm nay", "Hôm qua", "7 ngày qua", "30 ngày qua", "Tháng trước", "Tháng này", "Năm trước", "Năm nay", "Tùy chọn khác" }));
        CbThoiGianSanPham.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                CbThoiGianSanPhamItemStateChanged(evt);
            }
        });
        CbThoiGianSanPham.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                CbThoiGianSanPhamActionPerformed(evt);
            }
        });

        lblThoiGian.setText("Khoảng thời gian");

        CbTieuChi.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "sản phẩm bán chạy", "doanh thu cao nhất", " " }));
        CbTieuChi.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                CbTieuChiItemStateChanged(evt);
            }
        });

        excelBtn.setBorder(null);
        excelBtn.setForeground(new java.awt.Color(135, 172, 217));
        excelBtn.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Assets/icon_24px/excel.png"))); // NOI18N
        excelBtn.setText("Xuất excel");
        excelBtn.setFocusPainted(false);
        excelBtn.setFont(new java.awt.Font("Josefin Sans SemiBold", 0, 17)); // NOI18N
        excelBtn.setMaximumSize(new java.awt.Dimension(100, 40));
        excelBtn.setPreferredSize(new java.awt.Dimension(100, 40));
        excelBtn.setRadius(40);
        excelBtn.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseEntered(java.awt.event.MouseEvent evt) {
                excelBtnMouseEntered(evt);
            }
            public void mouseExited(java.awt.event.MouseEvent evt) {
                excelBtnMouseExited(evt);
            }
        });
        excelBtn.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                excelBtnActionPerformed(evt);
            }
        });

        pdfBtn.setBorder(null);
        pdfBtn.setForeground(new java.awt.Color(135, 172, 217));
        pdfBtn.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Assets/icon_24px/pdf.png"))); // NOI18N
        pdfBtn.setText("In pdf");
        pdfBtn.setFocusPainted(false);
        pdfBtn.setFont(new java.awt.Font("Josefin Sans SemiBold", 0, 17)); // NOI18N
        pdfBtn.setMaximumSize(new java.awt.Dimension(100, 40));
        pdfBtn.setPreferredSize(new java.awt.Dimension(100, 40));
        pdfBtn.setRadius(40);
        pdfBtn.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseEntered(java.awt.event.MouseEvent evt) {
                pdfBtnMouseEntered(evt);
            }
            public void mouseExited(java.awt.event.MouseEvent evt) {
                pdfBtnMouseExited(evt);
            }
        });
        pdfBtn.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                pdfBtnActionPerformed(evt);
            }
        });

        spngayketthuc.addPropertyChangeListener(new java.beans.PropertyChangeListener() {
            public void propertyChange(java.beans.PropertyChangeEvent evt) {
                spngayketthucPropertyChange(evt);
            }
        });

        spngaybatdau.addPropertyChangeListener(new java.beans.PropertyChangeListener() {
            public void propertyChange(java.beans.PropertyChangeEvent evt) {
                spngaybatdauPropertyChange(evt);
            }
        });

        jPanelChartSanPhamBan.setBackground(new java.awt.Color(255, 102, 153));
        jPanelChartSanPhamBan.setLayout(new java.awt.BorderLayout());

        cbTopSanPham.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Tất cả", "Top 3", "Top 5", "Top 10", "Top 20" }));
        cbTopSanPham.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                cbTopSanPhamItemStateChanged(evt);
            }
        });

        javax.swing.GroupLayout jPanel7Layout = new javax.swing.GroupLayout(jPanel7);
        jPanel7.setLayout(jPanel7Layout);
        jPanel7Layout.setHorizontalGroup(
            jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel7Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel7Layout.createSequentialGroup()
                        .addComponent(jPanelChartSanPhamBan, javax.swing.GroupLayout.PREFERRED_SIZE, 979, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(0, 0, Short.MAX_VALUE))
                    .addGroup(jPanel7Layout.createSequentialGroup()
                        .addComponent(lblThoiGian, javax.swing.GroupLayout.PREFERRED_SIZE, 98, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(0, 0, 0)
                        .addComponent(CbThoiGianSanPham, javax.swing.GroupLayout.PREFERRED_SIZE, 96, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(spngaybatdau, javax.swing.GroupLayout.PREFERRED_SIZE, 131, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(0, 0, 0)
                        .addComponent(spngayketthuc, javax.swing.GroupLayout.PREFERRED_SIZE, 129, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(CbTieuChi, 0, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(cbTopSanPham, javax.swing.GroupLayout.PREFERRED_SIZE, 105, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(4, 4, 4)
                        .addComponent(excelBtn, javax.swing.GroupLayout.PREFERRED_SIZE, 127, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(pdfBtn, javax.swing.GroupLayout.PREFERRED_SIZE, 115, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(18, 18, 18))
                    .addGroup(jPanel7Layout.createSequentialGroup()
                        .addComponent(jScrollPane3, javax.swing.GroupLayout.PREFERRED_SIZE, 979, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))))
        );
        jPanel7Layout.setVerticalGroup(
            jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel7Layout.createSequentialGroup()
                .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(CbThoiGianSanPham, javax.swing.GroupLayout.PREFERRED_SIZE, 31, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(lblThoiGian, javax.swing.GroupLayout.PREFERRED_SIZE, 31, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(CbTieuChi, javax.swing.GroupLayout.PREFERRED_SIZE, 31, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(cbTopSanPham, javax.swing.GroupLayout.PREFERRED_SIZE, 29, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(excelBtn, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(pdfBtn, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel7Layout.createSequentialGroup()
                        .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(spngaybatdau, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, 31, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(spngayketthuc, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, 31, javax.swing.GroupLayout.PREFERRED_SIZE))))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jScrollPane3, javax.swing.GroupLayout.PREFERRED_SIZE, 286, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanelChartSanPhamBan, javax.swing.GroupLayout.PREFERRED_SIZE, 310, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(76, 76, 76))
        );

        jTabbedPaneTheLoai.addTab("Sản phẩm", jPanel7);

        TableTheLoai.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null}
            },
            new String [] {
                "STT", "MaTL", "TenTL", "SL bán", "Số loại SP", "SL đơn  bán", "Doanh thu "
            }
        ) {
            Class[] types = new Class [] {
                java.lang.Integer.class, java.lang.String.class, java.lang.String.class, java.lang.Integer.class, java.lang.Object.class, java.lang.Integer.class, java.lang.String.class
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }
        });
        jScrollPane9.setViewportView(TableTheLoai);
        if (TableTheLoai.getColumnModel().getColumnCount() > 0) {
            TableTheLoai.getColumnModel().getColumn(1).setMinWidth(120);
            TableTheLoai.getColumnModel().getColumn(1).setPreferredWidth(120);
            TableTheLoai.getColumnModel().getColumn(1).setMaxWidth(120);
            TableTheLoai.getColumnModel().getColumn(2).setMinWidth(300);
            TableTheLoai.getColumnModel().getColumn(2).setPreferredWidth(300);
            TableTheLoai.getColumnModel().getColumn(2).setMaxWidth(300);
            TableTheLoai.getColumnModel().getColumn(3).setMinWidth(110);
            TableTheLoai.getColumnModel().getColumn(3).setPreferredWidth(110);
            TableTheLoai.getColumnModel().getColumn(3).setMaxWidth(110);
            TableTheLoai.getColumnModel().getColumn(5).setMinWidth(110);
            TableTheLoai.getColumnModel().getColumn(5).setPreferredWidth(110);
            TableTheLoai.getColumnModel().getColumn(5).setMaxWidth(110);
            TableTheLoai.getColumnModel().getColumn(6).setMinWidth(180);
            TableTheLoai.getColumnModel().getColumn(6).setPreferredWidth(180);
            TableTheLoai.getColumnModel().getColumn(6).setMaxWidth(180);
        }

        CbThoiGianTheLoai.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Hôm nay", "Hôm qua", "7 ngày qua", "30 ngày qua", "Tháng trước", "Tháng này", "Năm trước", "Năm nay", "Tùy chọn khác" }));
        CbThoiGianTheLoai.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                CbThoiGianTheLoaiItemStateChanged(evt);
            }
        });
        CbThoiGianTheLoai.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                CbThoiGianTheLoaiActionPerformed(evt);
            }
        });

        lblThoiGian2.setText("Khoảng thời gian");

        CbTieuChiTheLoai.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Thể loại bán chạy", "Doanh thu cao nhất", " " }));

        excelBtnTheLoai.setBorder(null);
        excelBtnTheLoai.setForeground(new java.awt.Color(135, 172, 217));
        excelBtnTheLoai.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Assets/icon_24px/excel.png"))); // NOI18N
        excelBtnTheLoai.setText("Xuất excel");
        excelBtnTheLoai.setFocusPainted(false);
        excelBtnTheLoai.setFont(new java.awt.Font("Josefin Sans SemiBold", 0, 17)); // NOI18N
        excelBtnTheLoai.setMaximumSize(new java.awt.Dimension(100, 40));
        excelBtnTheLoai.setPreferredSize(new java.awt.Dimension(100, 40));
        excelBtnTheLoai.setRadius(40);
        excelBtnTheLoai.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseEntered(java.awt.event.MouseEvent evt) {
                excelBtnTheLoaiMouseEntered(evt);
            }
            public void mouseExited(java.awt.event.MouseEvent evt) {
                excelBtnTheLoaiMouseExited(evt);
            }
        });
        excelBtnTheLoai.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                excelBtnTheLoaiActionPerformed(evt);
            }
        });

        pdfBtnTheLoai.setBorder(null);
        pdfBtnTheLoai.setForeground(new java.awt.Color(135, 172, 217));
        pdfBtnTheLoai.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Assets/icon_24px/pdf.png"))); // NOI18N
        pdfBtnTheLoai.setText("In pdf");
        pdfBtnTheLoai.setFocusPainted(false);
        pdfBtnTheLoai.setFont(new java.awt.Font("Josefin Sans SemiBold", 0, 17)); // NOI18N
        pdfBtnTheLoai.setMaximumSize(new java.awt.Dimension(100, 40));
        pdfBtnTheLoai.setPreferredSize(new java.awt.Dimension(100, 40));
        pdfBtnTheLoai.setRadius(40);
        pdfBtnTheLoai.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseEntered(java.awt.event.MouseEvent evt) {
                pdfBtnTheLoaiMouseEntered(evt);
            }
            public void mouseExited(java.awt.event.MouseEvent evt) {
                pdfBtnTheLoaiMouseExited(evt);
            }
        });
        pdfBtnTheLoai.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                pdfBtnTheLoaiActionPerformed(evt);
            }
        });

        tlngayketthuc.addPropertyChangeListener(new java.beans.PropertyChangeListener() {
            public void propertyChange(java.beans.PropertyChangeEvent evt) {
                tlngayketthucPropertyChange(evt);
            }
        });

        tlngaybatdau.addPropertyChangeListener(new java.beans.PropertyChangeListener() {
            public void propertyChange(java.beans.PropertyChangeEvent evt) {
                tlngaybatdauPropertyChange(evt);
            }
        });

        jPanelChartTheLoai.setBackground(new java.awt.Color(255, 102, 153));
        jPanelChartTheLoai.setLayout(new java.awt.BorderLayout());

        cbTopTheLoai.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Tất cả", "Top 3", "Top 5", "Top 10", "Top 20" }));
        cbTopTheLoai.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                cbTopTheLoaiItemStateChanged(evt);
            }
        });

        javax.swing.GroupLayout jPanel12Layout = new javax.swing.GroupLayout(jPanel12);
        jPanel12.setLayout(jPanel12Layout);
        jPanel12Layout.setHorizontalGroup(
            jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel12Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel12Layout.createSequentialGroup()
                        .addComponent(lblThoiGian2, javax.swing.GroupLayout.PREFERRED_SIZE, 98, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(0, 0, 0)
                        .addComponent(CbThoiGianTheLoai, javax.swing.GroupLayout.PREFERRED_SIZE, 96, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(tlngaybatdau, javax.swing.GroupLayout.PREFERRED_SIZE, 131, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(0, 0, 0)
                        .addComponent(tlngayketthuc, javax.swing.GroupLayout.PREFERRED_SIZE, 129, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(CbTieuChiTheLoai, 0, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(cbTopTheLoai, javax.swing.GroupLayout.PREFERRED_SIZE, 105, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(4, 4, 4)
                        .addComponent(excelBtnTheLoai, javax.swing.GroupLayout.PREFERRED_SIZE, 127, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(pdfBtnTheLoai, javax.swing.GroupLayout.PREFERRED_SIZE, 115, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(18, 18, 18))
                    .addGroup(jPanel12Layout.createSequentialGroup()
                        .addComponent(jScrollPane9, javax.swing.GroupLayout.PREFERRED_SIZE, 979, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                    .addGroup(jPanel12Layout.createSequentialGroup()
                        .addComponent(jPanelChartTheLoai, javax.swing.GroupLayout.PREFERRED_SIZE, 979, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(0, 0, Short.MAX_VALUE))))
        );
        jPanel12Layout.setVerticalGroup(
            jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel12Layout.createSequentialGroup()
                .addGroup(jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel12Layout.createSequentialGroup()
                        .addGroup(jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                            .addGroup(jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                                .addComponent(excelBtnTheLoai, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                .addComponent(pdfBtnTheLoai, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGroup(jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                .addComponent(CbThoiGianTheLoai, javax.swing.GroupLayout.PREFERRED_SIZE, 31, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addComponent(lblThoiGian2, javax.swing.GroupLayout.PREFERRED_SIZE, 31, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addComponent(CbTieuChiTheLoai, javax.swing.GroupLayout.PREFERRED_SIZE, 31, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addComponent(cbTopTheLoai, javax.swing.GroupLayout.PREFERRED_SIZE, 29, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addComponent(tlngaybatdau, javax.swing.GroupLayout.PREFERRED_SIZE, 31, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(0, 0, Short.MAX_VALUE))
                    .addGroup(jPanel12Layout.createSequentialGroup()
                        .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(tlngayketthuc, javax.swing.GroupLayout.PREFERRED_SIZE, 31, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jScrollPane9, javax.swing.GroupLayout.PREFERRED_SIZE, 286, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanelChartTheLoai, javax.swing.GroupLayout.PREFERRED_SIZE, 312, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(74, 74, 74))
        );

        jTabbedPaneTheLoai.addTab("Thể loại", jPanel12);

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jTabbedPaneTheLoai)
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jTabbedPaneTheLoai)
        );

        jTabbedPane1.addTab("Bán hàng", jPanel1);

        TableThoiGian.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null, null, null},
                {null, null, null, null, null, null},
                {null, null, null, null, null, null},
                {null, null, null, null, null, null}
            },
            new String [] {
                "STT", "Thời gian", "Số lượng đơn", "Số lượng SP", "Số loại SP", "Doanh thu"
            }
        ) {
            Class[] types = new Class [] {
                java.lang.Integer.class, java.lang.String.class, java.lang.Integer.class, java.lang.Integer.class, java.lang.Integer.class, java.lang.String.class
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }
        });
        jScrollPane4.setViewportView(TableThoiGian);
        if (TableThoiGian.getColumnModel().getColumnCount() > 0) {
            TableThoiGian.getColumnModel().getColumn(0).setMinWidth(50);
            TableThoiGian.getColumnModel().getColumn(0).setPreferredWidth(50);
            TableThoiGian.getColumnModel().getColumn(0).setMaxWidth(50);
        }

        lblThoiGian1.setText("Khoảng thời gian");

        CbThoiGian.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Hôm nay", "Hôm qua", "7 ngày qua", "30 ngày qua", "Tháng trước", "Tháng này", "Năm trước", "Năm nay", "Tùy chọn khác" }));
        CbThoiGian.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                CbThoiGianItemStateChanged(evt);
            }
        });
        CbThoiGian.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                CbThoiGianActionPerformed(evt);
            }
        });

        tgngaybatdau.addPropertyChangeListener(new java.beans.PropertyChangeListener() {
            public void propertyChange(java.beans.PropertyChangeEvent evt) {
                tgngaybatdauPropertyChange(evt);
            }
        });

        tgngayketthuc.addPropertyChangeListener(new java.beans.PropertyChangeListener() {
            public void propertyChange(java.beans.PropertyChangeEvent evt) {
                tgngayketthucPropertyChange(evt);
            }
        });

        excelThoiGian.setBorder(null);
        excelThoiGian.setForeground(new java.awt.Color(135, 172, 217));
        excelThoiGian.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Assets/icon_24px/excel.png"))); // NOI18N
        excelThoiGian.setText("Xuất excel");
        excelThoiGian.setFocusPainted(false);
        excelThoiGian.setFont(new java.awt.Font("Josefin Sans SemiBold", 0, 17)); // NOI18N
        excelThoiGian.setMaximumSize(new java.awt.Dimension(100, 40));
        excelThoiGian.setPreferredSize(new java.awt.Dimension(100, 40));
        excelThoiGian.setRadius(40);
        excelThoiGian.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseEntered(java.awt.event.MouseEvent evt) {
                excelThoiGianMouseEntered(evt);
            }
            public void mouseExited(java.awt.event.MouseEvent evt) {
                excelThoiGianMouseExited(evt);
            }
        });
        excelThoiGian.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                excelThoiGianActionPerformed(evt);
            }
        });

        pdfThoiGian.setBorder(null);
        pdfThoiGian.setForeground(new java.awt.Color(135, 172, 217));
        pdfThoiGian.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Assets/icon_24px/pdf.png"))); // NOI18N
        pdfThoiGian.setText("In pdf");
        pdfThoiGian.setFocusPainted(false);
        pdfThoiGian.setFont(new java.awt.Font("Josefin Sans SemiBold", 0, 17)); // NOI18N
        pdfThoiGian.setMaximumSize(new java.awt.Dimension(100, 40));
        pdfThoiGian.setPreferredSize(new java.awt.Dimension(100, 40));
        pdfThoiGian.setRadius(40);
        pdfThoiGian.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseEntered(java.awt.event.MouseEvent evt) {
                pdfThoiGianMouseEntered(evt);
            }
            public void mouseExited(java.awt.event.MouseEvent evt) {
                pdfThoiGianMouseExited(evt);
            }
        });
        pdfThoiGian.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                pdfThoiGianActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel9Layout = new javax.swing.GroupLayout(jPanel9);
        jPanel9.setLayout(jPanel9Layout);
        jPanel9Layout.setHorizontalGroup(
            jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel9Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jScrollPane4, javax.swing.GroupLayout.DEFAULT_SIZE, 1000, Short.MAX_VALUE)
                    .addGroup(jPanel9Layout.createSequentialGroup()
                        .addComponent(lblThoiGian1, javax.swing.GroupLayout.PREFERRED_SIZE, 98, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(CbThoiGian, javax.swing.GroupLayout.PREFERRED_SIZE, 96, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(tgngaybatdau, javax.swing.GroupLayout.PREFERRED_SIZE, 131, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(tgngayketthuc, javax.swing.GroupLayout.PREFERRED_SIZE, 129, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 241, Short.MAX_VALUE)
                        .addComponent(excelThoiGian, javax.swing.GroupLayout.PREFERRED_SIZE, 128, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(27, 27, 27)
                        .addComponent(pdfThoiGian, javax.swing.GroupLayout.PREFERRED_SIZE, 115, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap())
        );
        jPanel9Layout.setVerticalGroup(
            jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel9Layout.createSequentialGroup()
                .addGap(14, 14, 14)
                .addGroup(jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(lblThoiGian1, javax.swing.GroupLayout.PREFERRED_SIZE, 31, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(CbThoiGian, javax.swing.GroupLayout.PREFERRED_SIZE, 31, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(tgngaybatdau, javax.swing.GroupLayout.PREFERRED_SIZE, 31, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(tgngayketthuc, javax.swing.GroupLayout.PREFERRED_SIZE, 31, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                        .addComponent(excelThoiGian, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(pdfThoiGian, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jScrollPane4, javax.swing.GroupLayout.PREFERRED_SIZE, 619, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(76, Short.MAX_VALUE))
        );

        jTabbedPane1.addTab("Khách mua hàng theo thời gian", jPanel9);

        javax.swing.GroupLayout jPanel5Layout = new javax.swing.GroupLayout(jPanel5);
        jPanel5.setLayout(jPanel5Layout);
        jPanel5Layout.setHorizontalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel5Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel5Layout.createSequentialGroup()
                        .addComponent(jLabel6, javax.swing.GroupLayout.PREFERRED_SIZE, 80, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(0, 0, 0)
                        .addComponent(jLabel5, javax.swing.GroupLayout.PREFERRED_SIZE, 40, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(jTabbedPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 1001, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(7, Short.MAX_VALUE))
        );
        jPanel5Layout.setVerticalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel5Layout.createSequentialGroup()
                .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel5, javax.swing.GroupLayout.PREFERRED_SIZE, 40, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel6, javax.swing.GroupLayout.PREFERRED_SIZE, 40, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(0, 0, 0)
                .addComponent(jTabbedPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 780, Short.MAX_VALUE))
        );

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(this);
        this.setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 1020, Short.MAX_VALUE)
            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(layout.createSequentialGroup()
                    .addGap(0, 0, 0)
                    .addComponent(jPanel5, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGap(0, 0, Short.MAX_VALUE)))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 756, Short.MAX_VALUE)
            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(layout.createSequentialGroup()
                    .addComponent(jPanel5, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)))
        );
    }// </editor-fold>//GEN-END:initComponents

    private void jTabbedPanelMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jTabbedPanelMouseClicked
        // TODO add your handling code here:

    }//GEN-LAST:event_jTabbedPanelMouseClicked

    private void ThongKeTheoThangTrongNamMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_ThongKeTheoThangTrongNamMouseClicked
        // TODO add your handling code here:
    }//GEN-LAST:event_ThongKeTheoThangTrongNamMouseClicked

    private void ThongKeTheoNamMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_ThongKeTheoNamMouseClicked
        // TODO add your handling code here:
    }//GEN-LAST:event_ThongKeTheoNamMouseClicked

    private void excelBtnDoanhThuTheoNamActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_excelBtnDoanhThuTheoNamActionPerformed
        // TODO add your handling code here:
        String namBatDau = cbNamBatDau.getSelectedItem().toString();
        String namKetThuc = cbNamKetThuc.getSelectedItem().toString();
        // Gọi hàm chọn đường dẫn
        String filePath = sharedFunction.chooseFilePath("xlsx");
        if (filePath != null) {
            ExcelExporter.exportToExcel(tableTheoNam, filePath, namBatDau, namKetThuc, "Trần Hoài Bảo", "Báo cáo doanh thu", "NamBatDauNamKetThuc");
        }
    }//GEN-LAST:event_excelBtnDoanhThuTheoNamActionPerformed

    private void pdfBtnDoanhThuTheoNamActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_pdfBtnDoanhThuTheoNamActionPerformed
        // TODO add your handling code here:
        String namBatDau = cbNamBatDau.getSelectedItem().toString();
        String namKetThuc = cbNamKetThuc.getSelectedItem().toString();
        // Gọi hàm chọn đường dẫn
        String filePath = sharedFunction.chooseFilePath("pdf");
        if (filePath != null) {
            PdfExporter.exportToPdfDoanhThu(tableTheoNam, filePath, namBatDau, namKetThuc, "Nguyễn Minh Thuận", "Báo cáo doanh thu", "NamBatDauNamKetThuc");
        }

    }//GEN-LAST:event_pdfBtnDoanhThuTheoNamActionPerformed

    private void pdfBtnTheoThangActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_pdfBtnTheoThangActionPerformed
        // TODO add your handling code here:   ArrayList<ThongKeDoanhThuDTO> list = getDataFromTableTheoNam();
        String nam = cbNam.getSelectedItem().toString();

        // Gọi hàm chọn đường dẫn
        String filePath = sharedFunction.chooseFilePath("pdf");
        if (filePath != null) {
//            PdfExporter.exportToPdf(list, filePath, nam, nam, "Nguyễn Minh Thuận");
            PdfExporter.exportToPdfDoanhThu(tableTheoThang, filePath, nam, nam, "Nguyễn Minh Thuận", "Báo cáo doanh thu", "Nam");
        }
    }//GEN-LAST:event_pdfBtnTheoThangActionPerformed

    private void excelBtnTheoThangActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_excelBtnTheoThangActionPerformed
        // TODO add your handling code here:
        String namBatDau = cbNam.getSelectedItem().toString();
        // Gọi hàm chọn đường dẫn
        String filePath = sharedFunction.chooseFilePath("xlsx");
        if (filePath != null) {
            ExcelExporter.exportToExcel(tableTheoThang, filePath, namBatDau, namBatDau, "Nguyễn Minh Thuận", "Báo cáo doanh thu", "Nam");
        }

    }//GEN-LAST:event_excelBtnTheoThangActionPerformed

    private void btnThem3ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnThem3ActionPerformed
        // TODO add your handling code here:
        String nam = cbNam1.getSelectedItem().toString();
        String thang = cbThang.getSelectedItem().toString();
        // Gọi hàm chọn đường dẫn
        String filePath = sharedFunction.chooseFilePath("pdf");
        if (filePath != null) {
            PdfExporter.exportToPdfDoanhThu(tableTheoTungNgayTrongThang, filePath, nam, thang, "Nguyễn Minh Thuận", "Báo cáo doanh thu", "Thang");
        }
    }//GEN-LAST:event_btnThem3ActionPerformed

    private void btnThem5ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnThem5ActionPerformed
        // TODO add your handling code here:
        String nam = cbNam1.getSelectedItem().toString();
        String thang = cbThang.getSelectedItem().toString();
        // Gọi hàm chọn đường dẫn
        String filePath = sharedFunction.chooseFilePath("xlsx");
        if (filePath != null) {
            ExcelExporter.exportToExcel(tableTheoNam, filePath, nam, thang, "Nguyễn Minh Thuận", "Báo cáo doanh thu ", "Thang");
        }

    }//GEN-LAST:event_btnThem5ActionPerformed

    private void ThongKeTheoNgayTrongThangMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_ThongKeTheoNgayTrongThangMouseClicked
        // TODO add your handling code here:
    }//GEN-LAST:event_ThongKeTheoNgayTrongThangMouseClicked

    private void btnThem6ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnThem6ActionPerformed
        // TODO add your handling code here:
        java.util.Date startDate = DoanhThutgngaybatdau.getDate();
        java.util.Date endDate = DoanhThutgngayketthuc.getDate();
        SimpleDateFormat dateFormat = new SimpleDateFormat("dd/MM/yyyy");
        String formattedStartDate = dateFormat.format(startDate);
        String formattedEndDate = dateFormat.format(endDate);

        String filePath = sharedFunction.chooseFilePath("pdf");
        if (filePath != null) {
            PdfExporter.exportToPdfDoanhThu(TableTuNgayDenNgay, filePath, formattedStartDate, formattedEndDate, "Nguyễn Minh Thuận", "Báo cáo doanh thu", "NgayDenNgay");
        }
    }//GEN-LAST:event_btnThem6ActionPerformed

    private void btnThem8ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnThem8ActionPerformed
        // TODO add your handling code here:
        java.util.Date startDate = DoanhThutgngaybatdau.getDate();
        java.util.Date endDate = DoanhThutgngayketthuc.getDate();
        SimpleDateFormat dateFormat = new SimpleDateFormat("dd/MM/yyyy");
        String formattedStartDate = dateFormat.format(startDate);
        String formattedEndDate = dateFormat.format(endDate);

        String filePath = sharedFunction.chooseFilePath("xlsx");
        if (filePath != null) {
            ExcelExporter.exportToExcel(TableTuNgayDenNgay, filePath, formattedStartDate, formattedEndDate, "Nguyễn Minh Thuận", "Báo cáo doanh thu", "NgayDenNgay");
        }

    }//GEN-LAST:event_btnThem8ActionPerformed

    private void ThongKeTuNgayDenNgayMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_ThongKeTuNgayDenNgayMouseClicked
        // TODO add your handling code here:
    }//GEN-LAST:event_ThongKeTuNgayDenNgayMouseClicked

    private void excelBtnActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_excelBtnActionPerformed
        // TODO add your handling code here:
        java.util.Date startDate = spngaybatdau.getDate();
        java.util.Date endDate = spngayketthuc.getDate();
        SimpleDateFormat dateFormat = new SimpleDateFormat("dd/MM/yyyy");
        String formattedStartDate = dateFormat.format(startDate);
        String formattedEndDate = dateFormat.format(endDate);

        String filePath = sharedFunction.chooseFilePath("xlsx");
        if (filePath != null) {
            ExcelExporter.exportToExcel(TableSanPham, filePath, formattedStartDate, formattedEndDate, "Nguyễn Minh Thuận", "Danh sách sản phẩm bán ", "NgayDenNgay");
        }
    }//GEN-LAST:event_excelBtnActionPerformed

    private void pdfBtnActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_pdfBtnActionPerformed
        // TODO add your handling code here:
        java.util.Date startDate = spngaybatdau.getDate();
        java.util.Date endDate = spngayketthuc.getDate();
        SimpleDateFormat dateFormat = new SimpleDateFormat("dd/MM/yyyy");
        String formattedStartDate = dateFormat.format(startDate);
        String formattedEndDate = dateFormat.format(endDate);

        String filePath = sharedFunction.chooseFilePath("pdf");
        if (filePath != null) {
            PdfExporter.exportToPdfReport(formattedStartDate, formattedEndDate, TableSanPham, "Báo cáo kết quả sản phẩm bán từ ", filePath);
        }
    }//GEN-LAST:event_pdfBtnActionPerformed

    private void CbThoiGianSanPhamActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_CbThoiGianSanPhamActionPerformed
        // TODO add your handling code here:
        updateDateChoosers(spngaybatdau, spngayketthuc, CbThoiGianSanPham);
    }//GEN-LAST:event_CbThoiGianSanPhamActionPerformed

    private void CbThoiGianSanPhamItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_CbThoiGianSanPhamItemStateChanged
        // TODO add your handling code here:
    }//GEN-LAST:event_CbThoiGianSanPhamItemStateChanged

    private void spngaybatdauPropertyChange(java.beans.PropertyChangeEvent evt) {//GEN-FIRST:event_spngaybatdauPropertyChange
        // TODO add your handling code here:
      thongKeSanPhamBanTrongKhoangThoiGian();
    }//GEN-LAST:event_spngaybatdauPropertyChange

    private void spngayketthucPropertyChange(java.beans.PropertyChangeEvent evt) {//GEN-FIRST:event_spngayketthucPropertyChange
        // TODO add your handling code here:
        thongKeSanPhamBanTrongKhoangThoiGian();
    }//GEN-LAST:event_spngayketthucPropertyChange

    private void cbTopSanPhamItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_cbTopSanPhamItemStateChanged
        // TODO add your handling code here:
        thongKeSanPhamBanTrongKhoangThoiGian();
    }//GEN-LAST:event_cbTopSanPhamItemStateChanged

    private void CbThoiGianTheLoaiItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_CbThoiGianTheLoaiItemStateChanged
        // TODO add your handling code here:
    }//GEN-LAST:event_CbThoiGianTheLoaiItemStateChanged

    private void CbThoiGianTheLoaiActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_CbThoiGianTheLoaiActionPerformed
        // TODO add your handling code here:
        updateDateChoosers(tlngaybatdau, tlngayketthuc, CbThoiGianTheLoai);
    }//GEN-LAST:event_CbThoiGianTheLoaiActionPerformed

    private void excelBtnTheLoaiActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_excelBtnTheLoaiActionPerformed
        // TODO add your handling code here:
        java.util.Date startDate = tlngaybatdau.getDate();
        java.util.Date endDate = tlngayketthuc.getDate();
        SimpleDateFormat dateFormat = new SimpleDateFormat("dd/MM/yyyy");
        String formattedStartDate = dateFormat.format(startDate);
        String formattedEndDate = dateFormat.format(endDate);

        String filePath = sharedFunction.chooseFilePath("xlsx");
        if (filePath != null) {
            ExcelExporter.exportToExcel(TableTheLoai, filePath, formattedStartDate, formattedEndDate, "Nguyễn Minh Thuận", "Danh sách thể loại bán ", "NgayDenNgay");
        }
    }//GEN-LAST:event_excelBtnTheLoaiActionPerformed

    private void pdfBtnTheLoaiActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_pdfBtnTheLoaiActionPerformed
        // TODO add your handling code here:
        java.util.Date startDate = tlngaybatdau.getDate();
        java.util.Date endDate = tlngayketthuc.getDate();
        SimpleDateFormat dateFormat = new SimpleDateFormat("dd/MM/yyyy");
        String formattedStartDate = dateFormat.format(startDate);
        String formattedEndDate = dateFormat.format(endDate);

        String filePath = sharedFunction.chooseFilePath("pdf");
        if (filePath != null) {
            PdfExporter.exportToPdfReport(formattedStartDate, formattedEndDate, TableTheLoai, "Danh sách thể loại bán ", filePath);
        }
    }//GEN-LAST:event_pdfBtnTheLoaiActionPerformed

    private void tlngayketthucPropertyChange(java.beans.PropertyChangeEvent evt) {//GEN-FIRST:event_tlngayketthucPropertyChange
        // TODO add your handling code here:
        thongKeTheLoaiBanTrongKhoangThoiGian();
    }//GEN-LAST:event_tlngayketthucPropertyChange

    private void tlngaybatdauPropertyChange(java.beans.PropertyChangeEvent evt) {//GEN-FIRST:event_tlngaybatdauPropertyChange
        // TODO add your handling code here:
        java.util.Date startDate = tlngaybatdau.getDate();
        java.util.Date endDate = tlngayketthuc.getDate();

        // Kiểm tra ngày bắt đầu và kết thúc
        if (!isValidDateRange(startDate, endDate)) {
            JOptionPane.showMessageDialog(this, "Ngày bắt đầu không được lớn hơn ngày kết thúc", "Lỗi", JOptionPane.ERROR_MESSAGE);
            return;
        }
    }//GEN-LAST:event_tlngaybatdauPropertyChange

    private void cbTopTheLoaiItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_cbTopTheLoaiItemStateChanged
        // TODO add your handling code here:
        thongKeTheLoaiBanTrongKhoangThoiGian();
    }//GEN-LAST:event_cbTopTheLoaiItemStateChanged

    private void CbTieuChiItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_CbTieuChiItemStateChanged
        // TODO add your handling code here:
    }//GEN-LAST:event_CbTieuChiItemStateChanged

    private void cbNamKetThucItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_cbNamKetThucItemStateChanged
        // TODO add your handling code here:
    }//GEN-LAST:event_cbNamKetThucItemStateChanged

    private void cbNamBatDauItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_cbNamBatDauItemStateChanged
        // TODO add your handling code here:

    }//GEN-LAST:event_cbNamBatDauItemStateChanged

    private void cbNam1ItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_cbNam1ItemStateChanged
        // TODO add your handling code here:
        ThongKeDoanhThuTungNgayTrongThang();
    }//GEN-LAST:event_cbNam1ItemStateChanged

    private void cbNamBatDauActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cbNamBatDauActionPerformed
        // TODO add your handling code here:
        thongKeDoanhThuTuNamDenNam();
    }//GEN-LAST:event_cbNamBatDauActionPerformed

    private void cbNamKetThucActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cbNamKetThucActionPerformed
        // TODO add your handling code here:
        thongKeDoanhThuTuNamDenNam();
    }//GEN-LAST:event_cbNamKetThucActionPerformed

    private void jTabbedPane1MouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jTabbedPane1MouseClicked
        // TODO add your handling code here:
    }//GEN-LAST:event_jTabbedPane1MouseClicked

    private void CbThoiGianItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_CbThoiGianItemStateChanged
        // TODO add your handling code here:
    }//GEN-LAST:event_CbThoiGianItemStateChanged

    private void CbThoiGianActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_CbThoiGianActionPerformed
        // TODO add your handling code here:
        updateDateChoosers(tgngaybatdau, tgngayketthuc, CbThoiGian);
    }//GEN-LAST:event_CbThoiGianActionPerformed

    private void tgngaybatdauPropertyChange(java.beans.PropertyChangeEvent evt) {//GEN-FIRST:event_tgngaybatdauPropertyChange
        // TODO add your handling code here:
            thongKeHoaDonTrongKhoangThoiGian();
    }//GEN-LAST:event_tgngaybatdauPropertyChange

    private void tgngayketthucPropertyChange(java.beans.PropertyChangeEvent evt) {//GEN-FIRST:event_tgngayketthucPropertyChange
        // TODO add your handling code here:
        thongKeHoaDonTrongKhoangThoiGian();
  

    }//GEN-LAST:event_tgngayketthucPropertyChange

    private void excelThoiGianActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_excelThoiGianActionPerformed
        // TODO add your handling code here:
        java.util.Date startDate = tgngaybatdau.getDate();
        java.util.Date endDate = tgngayketthuc.getDate();
        SimpleDateFormat dateFormat = new SimpleDateFormat("dd/MM/yyyy");
        String formattedStartDate = dateFormat.format(startDate);
        String formattedEndDate = dateFormat.format(endDate);

        String filePath = sharedFunction.chooseFilePath("xlsx");
        if (filePath != null) {
            ExcelExporter.exportToExcel(TableThoiGian, filePath, formattedStartDate, formattedEndDate, "Nguyễn Minh Thuận", "Số hóa đơn bán trong khoảng thời gian ", "NgayDenNgay");
        }

    }//GEN-LAST:event_excelThoiGianActionPerformed

    private void pdfThoiGianActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_pdfThoiGianActionPerformed
        // TODO add your handling code here:
        java.util.Date startDate = tgngaybatdau.getDate();
        java.util.Date endDate = tgngayketthuc.getDate();
        SimpleDateFormat dateFormat = new SimpleDateFormat("dd/MM/yyyy");
        String formattedStartDate = dateFormat.format(startDate);
        String formattedEndDate = dateFormat.format(endDate);

        String filePath = sharedFunction.chooseFilePath("pdf");
        if (filePath != null) {
            PdfExporter.exportToPdfReport(formattedStartDate, formattedEndDate, TableThoiGian, "Báo cáo khách hàng mua theo khoảng thời gian từ ", filePath);
        }

    }//GEN-LAST:event_pdfThoiGianActionPerformed

    private void excelBtnMouseEntered(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_excelBtnMouseEntered
        // TODO add your handling code here:
        excelBtn.setCursor(Cursor.getPredefinedCursor(Cursor.HAND_CURSOR));
    }//GEN-LAST:event_excelBtnMouseEntered

    private void pdfBtnDoanhThuTheoNamMouseEntered(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_pdfBtnDoanhThuTheoNamMouseEntered
        // TODO add your handling code here:
        pdfBtnDoanhThuTheoNam.setCursor(Cursor.getPredefinedCursor(Cursor.HAND_CURSOR));
    }//GEN-LAST:event_pdfBtnDoanhThuTheoNamMouseEntered

    private void pdfBtnDoanhThuTheoNamMouseExited(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_pdfBtnDoanhThuTheoNamMouseExited
        // TODO add your handling code here:
        pdfBtnDoanhThuTheoNam.setCursor(Cursor.getDefaultCursor());
    }//GEN-LAST:event_pdfBtnDoanhThuTheoNamMouseExited

    private void excelBtnDoanhThuTheoNamMouseEntered(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_excelBtnDoanhThuTheoNamMouseEntered
        // TODO add your handling code here:
        excelBtnDoanhThuTheoNam.setCursor(Cursor.getPredefinedCursor(Cursor.HAND_CURSOR));
    }//GEN-LAST:event_excelBtnDoanhThuTheoNamMouseEntered

    private void excelBtnTheoThangMouseEntered(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_excelBtnTheoThangMouseEntered
        // TODO add your handling code here:
        excelBtnTheoThang.setCursor(Cursor.getPredefinedCursor(Cursor.HAND_CURSOR));
    }//GEN-LAST:event_excelBtnTheoThangMouseEntered

    private void excelBtnTheLoaiMouseEntered(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_excelBtnTheLoaiMouseEntered
        // TODO add your handling code here:
        excelBtnTheLoai.setCursor(Cursor.getPredefinedCursor(Cursor.HAND_CURSOR));
    }//GEN-LAST:event_excelBtnTheLoaiMouseEntered

    private void pdfBtnTheLoaiMouseEntered(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_pdfBtnTheLoaiMouseEntered
        // TODO add your handling code here:
        pdfBtnTheLoai.setCursor(Cursor.getPredefinedCursor(Cursor.HAND_CURSOR));
    }//GEN-LAST:event_pdfBtnTheLoaiMouseEntered

    private void excelThoiGianMouseEntered(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_excelThoiGianMouseEntered
        // TODO add your handling code here:
        excelThoiGian.setCursor(Cursor.getPredefinedCursor(Cursor.HAND_CURSOR));
    }//GEN-LAST:event_excelThoiGianMouseEntered

    private void pdfThoiGianMouseEntered(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_pdfThoiGianMouseEntered
        // TODO add your handling code here:
        pdfThoiGian.setCursor(Cursor.getPredefinedCursor(Cursor.HAND_CURSOR));
    }//GEN-LAST:event_pdfThoiGianMouseEntered

    private void excelThoiGianMouseExited(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_excelThoiGianMouseExited
        // TODO add your handling code here:
        excelThoiGian.setCursor(Cursor.getDefaultCursor());
    }//GEN-LAST:event_excelThoiGianMouseExited

    private void pdfThoiGianMouseExited(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_pdfThoiGianMouseExited
        // TODO add your handling code here:
        pdfThoiGian.setCursor(Cursor.getDefaultCursor());
    }//GEN-LAST:event_pdfThoiGianMouseExited

    private void excelBtnMouseExited(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_excelBtnMouseExited
        // TODO add your handling code here:
        excelBtn.setCursor(Cursor.getDefaultCursor());
    }//GEN-LAST:event_excelBtnMouseExited

    private void pdfBtnMouseExited(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_pdfBtnMouseExited
        // TODO add your handling code here:
        pdfBtn.setCursor(Cursor.getDefaultCursor());
    }//GEN-LAST:event_pdfBtnMouseExited

    private void excelBtnTheLoaiMouseExited(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_excelBtnTheLoaiMouseExited
        // TODO add your handling code here:
        excelBtnTheLoai.setCursor(Cursor.getDefaultCursor());
    }//GEN-LAST:event_excelBtnTheLoaiMouseExited

    private void pdfBtnTheLoaiMouseExited(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_pdfBtnTheLoaiMouseExited
        // TODO add your handling code here:
        pdfBtnTheLoai.setCursor(Cursor.getDefaultCursor());
    }//GEN-LAST:event_pdfBtnTheLoaiMouseExited

    private void excelBtnDoanhThuTheoNamMouseExited(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_excelBtnDoanhThuTheoNamMouseExited
        // TODO add your handling code here:
        excelBtnDoanhThuTheoNam.setCursor(Cursor.getDefaultCursor());
    }//GEN-LAST:event_excelBtnDoanhThuTheoNamMouseExited

    private void excelBtnTheoThangMouseExited(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_excelBtnTheoThangMouseExited
        // TODO add your handling code here:
        excelBtnTheoThang.setCursor(Cursor.getDefaultCursor());
    }//GEN-LAST:event_excelBtnTheoThangMouseExited

    private void pdfBtnMouseEntered(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_pdfBtnMouseEntered
        // TODO add your handling code here:
        pdfBtn.setCursor(Cursor.getPredefinedCursor(Cursor.HAND_CURSOR));
    }//GEN-LAST:event_pdfBtnMouseEntered

    private void pdfBtnTheoThangMouseEntered(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_pdfBtnTheoThangMouseEntered
        // TODO add your handling code here:
        pdfBtnTheoThang.setCursor(Cursor.getPredefinedCursor(Cursor.HAND_CURSOR));
    }//GEN-LAST:event_pdfBtnTheoThangMouseEntered

    private void pdfBtnTheoThangMouseExited(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_pdfBtnTheoThangMouseExited
        // TODO add your handling code here:
        pdfBtnTheoThang.setCursor(Cursor.getDefaultCursor());
    }//GEN-LAST:event_pdfBtnTheoThangMouseExited

    private void DoanhThuCbThoiGianItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_DoanhThuCbThoiGianItemStateChanged
        // TODO add your handling code here:
    }//GEN-LAST:event_DoanhThuCbThoiGianItemStateChanged

    private void DoanhThuCbThoiGianActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_DoanhThuCbThoiGianActionPerformed
        // TODO add your handling code here:
        updateDateChoosers(DoanhThutgngaybatdau, DoanhThutgngayketthuc, DoanhThuCbThoiGian);
    }//GEN-LAST:event_DoanhThuCbThoiGianActionPerformed

    private void DoanhThutgngaybatdauPropertyChange(java.beans.PropertyChangeEvent evt) {//GEN-FIRST:event_DoanhThutgngaybatdauPropertyChange
        // TODO add your handling code here:
        ThongKeDoanhThuTuNgayDenNgay();
    }//GEN-LAST:event_DoanhThutgngaybatdauPropertyChange

    private void DoanhThutgngayketthucPropertyChange(java.beans.PropertyChangeEvent evt) {//GEN-FIRST:event_DoanhThutgngayketthucPropertyChange
        // TODO add your handling code here:
        ThongKeDoanhThuTuNgayDenNgay();
    }//GEN-LAST:event_DoanhThutgngayketthucPropertyChange

    private void cbNamItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_cbNamItemStateChanged
        // TODO add your handling code here:
        thongKeDoanhThuTheoThangTrongNam();
    }//GEN-LAST:event_cbNamItemStateChanged

    private void cbThangItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_cbThangItemStateChanged
        // TODO add your handling code here:
        ThongKeDoanhThuTungNgayTrongThang();
    }//GEN-LAST:event_cbThangItemStateChanged

    private void populateComboBox(JComboBox<String> comboBox) {
        Set<Integer> years = tkBUS.getDistinctYears();

        // Chuyển Set thành List và sắp xếp giảm dần
        List<Integer> sortedYears = new ArrayList<>(years);
        Collections.sort(sortedYears, Collections.reverseOrder());

        comboBox.removeAllItems();

        for (Integer year : sortedYears) {
            comboBox.addItem(year + "");
        }

    }

    private void loadDataTableDoanhThu(DefaultTableModel tableModel, ArrayList<ThongKeDoanhThuDTO> ketQua) {
        tableModel.setRowCount(0);

        for (ThongKeDoanhThuDTO doanhThu : ketQua) {
            String von = sharedFunction.formatVND(doanhThu.getVon());
            String doanhthu = sharedFunction.formatVND(doanhThu.getDoanhThu());
            String loiNhuan = sharedFunction.formatVND(doanhThu.getLoiNhuan());
            Object[] rowData = {doanhThu.getThoiGian(), von, doanhthu, loiNhuan};
            tableModel.addRow(rowData);
        }
    }

    private void loadDataTableSanPhamBan(DefaultTableModel tableModel, ArrayList<ThongKeSanPhamBanDTO> ketQua, int selectedRowCount) {
        tableModel.setRowCount(0);

        int count = 0;
        for (ThongKeSanPhamBanDTO sp : ketQua) {
            if (count >= selectedRowCount) {
                break; // Đã hiển thị đủ số lượng dòng được chọn
            }

            String masp = sharedFunction.FormatID("SP", Integer.parseInt(sp.getMaSP()));
            String tenSP = sp.getTenSP();
            int soLuong = sp.getSoLuong();
            int soLuongDon = sp.getSoLuongDon();
            String doanhthu = sharedFunction.formatVND(sp.getDoanhThu());
            Object[] rowData = {count + 1, masp, tenSP, soLuong, soLuongDon, doanhthu};
            tableModel.addRow(rowData);

            count++;
        }
    }

    private void loadDataTableTheLoaiBan(DefaultTableModel tableModel, ArrayList<ThongKeTheLoaiBanDTO> ketQua, int selectedRowCount) {
        tableModel.setRowCount(0);

        int count = 0;
        for (ThongKeTheLoaiBanDTO tl : ketQua) {
            if (count >= selectedRowCount) {
                break;
            }

            String masp = sharedFunction.FormatID("TL", Integer.parseInt(tl.getMaTL()));
            String tenSP = tl.getTenTL();
            int soLuong = tl.getSoLuong();
            int soLuongDon = tl.getSoLuongDon();
            int soLoaiSP = tl.getSoLoaiSP();
            String doanhthu = sharedFunction.formatVND(tl.getDoanhThu());
            Object[] rowData = {count + 1, masp, tenSP, soLuong, soLoaiSP, soLuongDon, doanhthu};
            tableModel.addRow(rowData);

            count++;
        }
    }

    private void loadDataTableHoaDonBan(DefaultTableModel tableModel, ArrayList<ThongKeHoaDonBanDTO> ketQua) {
        tableModel.setRowCount(0);

        int count = 1;
        for (ThongKeHoaDonBanDTO hd : ketQua) {
            String thoiGian = hd.getThoiGian();
            int soHoaDon = hd.getSoHoaDon();
            int soLuongSP = hd.getSoSP();
            int soLoaiSP = hd.getSoLoaiSP();
            String doanhthu = sharedFunction.formatVND(hd.getDoanhThu());
            Object[] rowData = {count++, thoiGian, soHoaDon, soLuongSP, soLoaiSP, doanhthu};
            tableModel.addRow(rowData);
        }

    }

    private void formatTable() {
        sharedFunction.EditHeaderTable(tableTheoNam);
        sharedFunction.EditTableContent(tableTheoNam);
        sharedFunction.EditHeaderTable(tableTheoThang);
        sharedFunction.EditTableContent(tableTheoThang);
        sharedFunction.EditHeaderTable(TableTuNgayDenNgay);
        sharedFunction.EditTableContent(TableTuNgayDenNgay);
        sharedFunction.EditHeaderTable(tableTheoTungNgayTrongThang);
        sharedFunction.EditTableContent(tableTheoTungNgayTrongThang);
        sharedFunction.EditHeaderTable(TableSanPham);
        sharedFunction.EditTableContent(TableSanPham);
        sharedFunction.EditHeaderTable(TableTheLoai);
        sharedFunction.EditTableContent(TableTheLoai);
        sharedFunction.EditHeaderTable(TableThoiGian);
        sharedFunction.EditTableContent(TableThoiGian);

    }

    private void populateComboBoxALL() {
        populateComboBox(cbNamBatDau);
        populateComboBox(cbNamKetThuc);
        populateComboBox(cbNam);
        populateComboBox(cbNam1);
    }

    private void thongKeDoanhThuTuNamDenNam() {
        String selectedNamBatDau = (String) cbNamBatDau.getSelectedItem();
        String selectedNamKetThuc = (String) cbNamKetThuc.getSelectedItem();

        if (selectedNamBatDau == null || selectedNamKetThuc == null) {
            return;
        }

        int namBatDau = Integer.parseInt(selectedNamBatDau);
        int namKetThuc = Integer.parseInt(selectedNamKetThuc);

        if (!isValidYearRange(namBatDau, namKetThuc)) {
            cbNamKetThuc.setSelectedItem(selectedNamBatDau);
            return;
        }

        ArrayList<ThongKeDoanhThuDTO> result = tkBUS.thongKeDoanhThuTuNamDenNam(namBatDau, namKetThuc);
        loadDataTableDoanhThu((DefaultTableModel) tableTheoNam.getModel(), result);
        loadDataChartTheoNam(result);
    }

    private void thongKeDoanhThuTheoThangTrongNam() {
        int selectedYear = Integer.parseInt((String) cbNam.getSelectedItem());
        ArrayList<ThongKeDoanhThuDTO> result = tkBUS.thongKeDoanhThuTheoThang(selectedYear);
        loadDataTableDoanhThu((DefaultTableModel) tableTheoThang.getModel(), result);
        loadDataChartTheoThang(result);
    }

    private void ThongKeDoanhThuTungNgayTrongThang() {
        String selectedMonthString = cbThang.getSelectedItem().toString();
        int selectedYear = Integer.parseInt((String) cbNam1.getSelectedItem());
        String monthNumberString = selectedMonthString.substring(6);
        int selectedMonth = Integer.parseInt(monthNumberString);
        ArrayList<ThongKeDoanhThuDTO> result = tkBUS.thongKeDoanhThuTungNgayTrongThang(selectedYear, selectedMonth);
        loadDataTableDoanhThu((DefaultTableModel) tableTheoTungNgayTrongThang.getModel(), result);
        loadDataChartTungNgayTrongThang(result);

    }

    private void ThongKeDoanhThuTuNgayDenNgay() {
        // Lấy ngày bắt đầu và kết thúc từ JDateChooser
        java.util.Date startDate = DoanhThutgngaybatdau.getDate();
        java.util.Date endDate = DoanhThutgngayketthuc.getDate();
        // Kiểm tra ngày bắt đầu và kết thúc
        if (!isValidDateRange(startDate, endDate)) {
            JOptionPane.showMessageDialog(this, "Ngày bắt đầu không được lớn hơn ngày kết thúc", "Lỗi", JOptionPane.ERROR_MESSAGE);
            DoanhThutgngayketthuc.setDate(startDate);
            return;
        }
        ArrayList<ThongKeDoanhThuDTO> result = tkBUS.thongKeDoanhThuTuNgayDenNgay(startDate, endDate);
        loadDataTableDoanhThu((DefaultTableModel) TableTuNgayDenNgay.getModel(), result);

    }

    private void loadDataChartTungNgayTrongThang(ArrayList<ThongKeDoanhThuDTO> list) {
        jPanelChartNgay.removeAll();
        chart = new Chart();
//        chart.addLegend("Vốn", new Color(245, 189, 135));
        chart.addLegend("Doanh thu", new Color(135, 189, 245));
//        chart.addLegend("Lợi nhuận", new Color(189, 135, 245));
        for (ThongKeDoanhThuDTO i : list) {
//            chart.addData(new ModelChart("" + i.getThoiGian(), new double[]{i.getVon(), i.getDoanhThu(), i.getLoiNhuan()}));
            chart.addData(new ModelChart("" + i.getThoiGian(), new double[]{i.getDoanhThu()}));
        }
        chart.repaint();
        chart.validate();
        jPanelChartNgay.add(chart);
        jPanelChartNgay.repaint();
        jPanelChartNgay.validate();
    }

    private void loadDataChartTheoNam(ArrayList<ThongKeDoanhThuDTO> list) {
        jPanelChartNam.removeAll();
        chart = new Chart();
        chart.addLegend("Vốn", new Color(245, 189, 135));
        chart.addLegend("Doanh thu", new Color(135, 189, 245));
        chart.addLegend("Lợi nhuận", new Color(189, 135, 245));
        for (ThongKeDoanhThuDTO i : list) {
            chart.addData(new ModelChart("Năm " + i.getThoiGian(), new double[]{i.getVon(), i.getDoanhThu(), i.getLoiNhuan()}));
        }
        chart.repaint();
        chart.validate();
        jPanelChartNam.add(chart);
        jPanelChartNam.repaint();
        jPanelChartNam.validate();
    }

    private void loadDataChartTheoThang(ArrayList<ThongKeDoanhThuDTO> list) {
        jPanelChartThang.removeAll();
        chart = new Chart();
        chart.addLegend("Vốn", new Color(245, 189, 135));
        chart.addLegend("Doanh thu", new Color(135, 189, 245));
        chart.addLegend("Lợi nhuận", new Color(189, 135, 245));
        for (ThongKeDoanhThuDTO i : list) {
            chart.addData(new ModelChart("Tháng" + i.getThoiGian(), new double[]{i.getVon(), i.getDoanhThu(), i.getLoiNhuan()}));
        }
        chart.repaint();
        chart.validate();
        jPanelChartThang.add(chart);
        jPanelChartThang.repaint();
        jPanelChartThang.validate();
    }
// thống kê sản phẩm bán

    private void updateDateChoosers(JDateChooser ngaybatdau, JDateChooser ngayketthuc, JComboBox<String> cb) {
        String selectedRange = (String) cb.getSelectedItem();

        Calendar calendar = Calendar.getInstance();
        // Set định dạng ngày tháng năm cho JDateChooser
        ngaybatdau.setDateFormatString("dd/MM/yyyy");
        ngayketthuc.setDateFormatString("dd/MM/yyyy");
        ngaybatdau.setDate(null);
        ngayketthuc.setDate(null);
        if (null == selectedRange) {
            ngaybatdau.setDate(null);
            ngayketthuc.setDate(null);
        } else {
            switch (selectedRange) {
                case "Hôm nay" -> {
                    ngaybatdau.setDate(calendar.getTime());
                    ngayketthuc.setDate(calendar.getTime());
                }
                case "Hôm qua" -> {
                    calendar.add(Calendar.DATE, -1);
                    ngaybatdau.setDate(calendar.getTime());
                    ngayketthuc.setDate(calendar.getTime());
                }
                case "7 ngày qua" -> {
                    calendar.add(Calendar.DATE, -6);
                    ngaybatdau.setDate(calendar.getTime());
                    ngayketthuc.setDate(Calendar.getInstance().getTime());
                }
                case "30 ngày qua" -> {
                    calendar.add(Calendar.DATE, -29);
                    ngaybatdau.setDate(calendar.getTime());
                    ngayketthuc.setDate(Calendar.getInstance().getTime());
                }
                case "Tháng trước" -> {
                    calendar.add(Calendar.MONTH, -1);
                    calendar.set(Calendar.DAY_OF_MONTH, 1);
                    ngaybatdau.setDate(calendar.getTime());
                    calendar.set(Calendar.DAY_OF_MONTH, calendar.getActualMaximum(Calendar.DAY_OF_MONTH));
                    ngayketthuc.setDate(calendar.getTime());
                }
                case "Tháng này" -> {
                    calendar.set(Calendar.DAY_OF_MONTH, 1);
                    ngaybatdau.setDate(calendar.getTime());
                    calendar.set(Calendar.DAY_OF_MONTH, calendar.getActualMaximum(Calendar.DAY_OF_MONTH));
                    ngayketthuc.setDate(calendar.getTime());
                }
                case "Năm trước" -> {
                    calendar.add(Calendar.YEAR, -1);
                    calendar.set(Calendar.MONTH, 0);
                    calendar.set(Calendar.DAY_OF_MONTH, 1);
                    ngaybatdau.setDate(calendar.getTime());
                    calendar.set(Calendar.MONTH, 11);
                    calendar.set(Calendar.DAY_OF_MONTH, 31);
                    ngayketthuc.setDate(calendar.getTime());
                }
                case "Năm nay" -> {
                    calendar.set(Calendar.MONTH, 0);
                    calendar.set(Calendar.DAY_OF_MONTH, 1);
                    ngaybatdau.setDate(calendar.getTime());
                    calendar.set(Calendar.MONTH, 11);
                    calendar.set(Calendar.DAY_OF_MONTH, 31);
                    ngayketthuc.setDate(calendar.getTime());
                }
                default -> {
                    ngaybatdau.setDate(null);
                    ngayketthuc.setDate(null);
                }
            }
        }
    }

    private void setDefaultValues(JDateChooser ngaybatdau, JDateChooser ngayketthuc, JComboBox<String> cb) {
        // Set giá trị mặc định cho cbTopSanPham
        cb.setSelectedItem("7 ngày qua");
        Calendar calendar = Calendar.getInstance();
        // Set định dạng ngày tháng năm cho JDateChooser
        ngaybatdau.setDateFormatString("dd/MM/yyyy");
        ngayketthuc.setDateFormatString("dd/MM/yyyy");
        calendar.add(Calendar.DATE, -6);
        ngaybatdau.setDate(calendar.getTime());
        ngayketthuc.setDate(Calendar.getInstance().getTime());
    }

    private void thongKeSanPhamBanTrongKhoangThoiGian() {
        // Lấy ngày bắt đầu và kết thúc từ JDateChooser
        java.util.Date startDate = spngaybatdau.getDate();
        java.util.Date endDate = spngayketthuc.getDate();

        // Kiểm tra ngày bắt đầu và kết thúc
        if (!isValidDateRange(startDate, endDate)) {
            JOptionPane.showMessageDialog(this, "Ngày bắt đầu không được lớn hơn ngày kết thúc", "Lỗi", JOptionPane.ERROR_MESSAGE);
            spngayketthuc.setDate(startDate);
            return;
        }

        ArrayList<ThongKeSanPhamBanDTO> result = tkBUS.thongKeSanPhamBanTrongKhoangThoiGian(startDate, endDate);

        // Chọn số lượng dòng để hiển thị
        int selectedRowCount = getSelectedRowCount(cbTopSanPham);

        // Hiển thị số lượng dòng tương ứng trên bảng và biểu đồ
        loadDataTableSanPhamBan((DefaultTableModel) TableSanPham.getModel(), result, selectedRowCount);
        loadDataChartSanPhamBan(result, selectedRowCount);
    }

    private void thongKeTheLoaiBanTrongKhoangThoiGian() {
        // Lấy ngày bắt đầu và kết thúc từ JDateChooser
        java.util.Date startDate = tlngaybatdau.getDate();
        java.util.Date endDate = tlngayketthuc.getDate();

        // Kiểm tra ngày bắt đầu và kết thúc
        if (!isValidDateRange(startDate, endDate)) {
            JOptionPane.showMessageDialog(this, "Ngày bắt đầu không được lớn hơn ngày kết thúc", "Lỗi", JOptionPane.ERROR_MESSAGE);
            return;
        }

        ArrayList<ThongKeTheLoaiBanDTO> result = tkBUS.thongKeTheLoaiTrongKhoangThoiGian(startDate, endDate);

        // Chọn số lượng dòng để hiển thị
        int selectedRowCount = getSelectedRowCount(cbTopTheLoai);

        // Hiển thị số lượng dòng tương ứng trên bảng và biểu đồ
        loadDataTableTheLoaiBan((DefaultTableModel) TableTheLoai.getModel(), result, selectedRowCount);
        loadDataChartTheLoaiBan(result, selectedRowCount);
    }

    private void thongKeHoaDonTrongKhoangThoiGian() {
        // Lấy ngày bắt đầu và kết thúc từ JDateChooser
        java.util.Date startDate = tgngaybatdau.getDate();
        java.util.Date endDate = tgngayketthuc.getDate();

        // Kiểm tra ngày bắt đầu và kết thúc
        if (!isValidDateRange(startDate, endDate)) {
            JOptionPane.showMessageDialog(this, "Ngày bắt đầu không được lớn hơn ngày kết thúc", "Lỗi", JOptionPane.ERROR_MESSAGE);
            tgngayketthuc.setDate(startDate);
            return;
        }
        ArrayList<ThongKeHoaDonBanDTO> result = tkBUS.thongKeHoaDonTrongKhoangThoiGian(startDate, endDate);

        loadDataTableHoaDonBan((DefaultTableModel) TableThoiGian.getModel(), result);

    }

    // Phương thức kiểm tra ngày bắt đầu và kết thúc
    private boolean isValidDateRange(java.util.Date startDate, java.util.Date endDate) {
        return startDate == null || endDate == null || !startDate.after(endDate);
    }

    private boolean isValidYearRange(int namBatDau, int namKetThuc) {
        if (namBatDau > namKetThuc) {
            JOptionPane.showMessageDialog(this, "Năm bắt đầu không được lớn hơn năm kết thúc", "Lỗi", JOptionPane.ERROR_MESSAGE);
            return false;
        }
        return true;
    }

    private void loadDataChartSanPhamBan(ArrayList<ThongKeSanPhamBanDTO> list, int number) {
        jPanelChartSanPhamBan.removeAll();
        chart = new Chart();
        chart.addLegend("Số lượng sản phẩm", new Color(245, 189, 135));
        chart.addLegend("Số lượng đơn", new Color(135, 189, 245));
        int count = 0;
        for (ThongKeSanPhamBanDTO i : list) {
            chart.addData(new ModelChart(sharedFunction.FormatID("SP", Integer.parseInt(i.getMaSP())), new double[]{i.getSoLuong(), i.getSoLuongDon()}));
            count++;
            if (count == number) {
                break;
            }
        }
        chart.repaint();
        chart.validate();
        jPanelChartSanPhamBan.add(chart);
        jPanelChartSanPhamBan.repaint();
        jPanelChartSanPhamBan.validate();
    }

    private void loadDataChartTheLoaiBan(ArrayList<ThongKeTheLoaiBanDTO> list, int number) {
        jPanelChartTheLoai.removeAll();
        chart = new Chart();
        chart.addLegend("Số lượng", new Color(189, 135, 245));
        chart.addLegend("Số loại sản phẩm", new Color(245, 189, 135));
        chart.addLegend("Số lượng đơn", new Color(135, 189, 245));
        int count = 0;
        for (ThongKeTheLoaiBanDTO i : list) {
            chart.addData(new ModelChart(sharedFunction.FormatID("TL", Integer.parseInt(i.getMaTL())), new double[]{i.getSoLuong(), i.getSoLoaiSP(), i.getSoLuongDon()}));
            count++;
            if (count == number) {
                break;
            }
        }
        chart.repaint();
        chart.validate();
        jPanelChartTheLoai.add(chart);
        jPanelChartTheLoai.repaint();
        jPanelChartTheLoai.validate();
    }
// thống kê hóa đơn bán trong khoảng thời gian

    private int getSelectedRowCount(JComboBox<String> cb) {
        // Lấy giá trị được chọn từ JComboBox
        String selectedOption = (String) cb.getSelectedItem();

        // Xử lý dựa trên giá trị được chọn
        return switch (selectedOption) {
            case "Tất cả" ->
                Integer.MAX_VALUE;
            case "Top 3" ->
                3;
            case "Top 5" ->
                5;
            case "Top 10" ->
                10;
            case "Top 20" ->
                20;
            default ->
                0;
        }; // Hiển thị tất cả dòng
    }


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JComboBox<String> CbThoiGian;
    private javax.swing.JComboBox<String> CbThoiGianSanPham;
    private javax.swing.JComboBox<String> CbThoiGianTheLoai;
    private javax.swing.JComboBox<String> CbTieuChi;
    private javax.swing.JComboBox<String> CbTieuChiTheLoai;
    private javax.swing.JComboBox<String> DoanhThuCbThoiGian;
    private com.toedter.calendar.JDateChooser DoanhThutgngaybatdau;
    private com.toedter.calendar.JDateChooser DoanhThutgngayketthuc;
    private javax.swing.JPanel PanelThongKeTheoNam;
    private javax.swing.JPanel PanelThongKeTheoThang;
    private javax.swing.JPanel PanelThongKeTheoThang1;
    private javax.swing.JPanel PanelThongKeTheoThang2;
    private javax.swing.JTable TableSanPham;
    private javax.swing.JTable TableTheLoai;
    private javax.swing.JTable TableThoiGian;
    private javax.swing.JTable TableTuNgayDenNgay;
    private javax.swing.JPanel ThongKeTheoNam;
    private javax.swing.JPanel ThongKeTheoNgayTrongThang;
    private javax.swing.JPanel ThongKeTheoThangTrongNam;
    private javax.swing.JPanel ThongKeTuNgayDenNgay;
    private Components.ButtonRadius btnThem3;
    private Components.ButtonRadius btnThem5;
    private Components.ButtonRadius btnThem6;
    private Components.ButtonRadius btnThem8;
    private javax.swing.JComboBox<String> cbNam;
    private javax.swing.JComboBox<String> cbNam1;
    private javax.swing.JComboBox<String> cbNamBatDau;
    private javax.swing.JComboBox<String> cbNamKetThuc;
    private javax.swing.JComboBox<String> cbThang;
    private javax.swing.JComboBox<String> cbTopSanPham;
    private javax.swing.JComboBox<String> cbTopTheLoai;
    private Components.ButtonRadius excelBtn;
    private Components.ButtonRadius excelBtnDoanhThuTheoNam;
    private Components.ButtonRadius excelBtnTheLoai;
    private Components.ButtonRadius excelBtnTheoThang;
    private Components.ButtonRadius excelThoiGian;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel12;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel5;
    private javax.swing.JPanel jPanel7;
    private javax.swing.JPanel jPanel9;
    private javax.swing.JPanel jPanelChartNam;
    private javax.swing.JPanel jPanelChartNgay;
    private javax.swing.JPanel jPanelChartSanPhamBan;
    private javax.swing.JPanel jPanelChartThang;
    private javax.swing.JPanel jPanelChartTheLoai;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JScrollPane jScrollPane3;
    private javax.swing.JScrollPane jScrollPane4;
    private javax.swing.JScrollPane jScrollPane6;
    private javax.swing.JScrollPane jScrollPane7;
    private javax.swing.JScrollPane jScrollPane9;
    private javax.swing.JTabbedPane jTabbedPane1;
    private javax.swing.JTabbedPane jTabbedPaneTheLoai;
    private javax.swing.JTabbedPane jTabbedPanel;
    private javax.swing.JLabel lblNam;
    private javax.swing.JLabel lblNam1;
    private javax.swing.JLabel lblNamBatDau;
    private javax.swing.JLabel lblNamKetThuc;
    private javax.swing.JLabel lblNamKetThuc2;
    private javax.swing.JLabel lblThoiGian;
    private javax.swing.JLabel lblThoiGian1;
    private javax.swing.JLabel lblThoiGian2;
    private javax.swing.JLabel lblThoiGian3;
    private Components.ButtonRadius pdfBtn;
    private Components.ButtonRadius pdfBtnDoanhThuTheoNam;
    private Components.ButtonRadius pdfBtnTheLoai;
    private Components.ButtonRadius pdfBtnTheoThang;
    private Components.ButtonRadius pdfThoiGian;
    private com.toedter.calendar.JDateChooser spngaybatdau;
    private com.toedter.calendar.JDateChooser spngayketthuc;
    private javax.swing.JTable tableTheoNam;
    private javax.swing.JTable tableTheoThang;
    private javax.swing.JTable tableTheoTungNgayTrongThang;
    private com.toedter.calendar.JDateChooser tgngaybatdau;
    private com.toedter.calendar.JDateChooser tgngayketthuc;
    private com.toedter.calendar.JDateChooser tlngaybatdau;
    private com.toedter.calendar.JDateChooser tlngayketthuc;
    // End of variables declaration//GEN-END:variables
}
